Document Title:  DP_20040914.txt	
Product Version: ICAD 5
Date:  14.09.2004
Engineer: Denis Petrov

1. Process Checklist :
* Regress run without new failures: Y/N
* Did you test it? : Y/N
* Code Reviewed By: 
* Docs Changes Required: Y/N
* Submitted to branch(es):
R50_Release

2. Modules Affected :
ICAD

3.  Overview:

The following problem is fixed:
deleting IMAGE and adding another crashes ICAD (Bugzilla 78881).

Special case in the function deleteEnts() handles deletion of IMAGEs:
1) At first it deletes IMAGEDEF_REACTOR and removes it from objects list.
2) After that it deletes reference to IMAGEDEF_REACTOR from IMAGEDEF.

The reference is deleted by:
1) Performing (entget) of IMAGEDEF.
2) Removing corresponding list item and doing (entmod).

But with recent changes the (entget) of IMAGEDEF fails 
because IMAGEDEF has a reference to physically deleted object.
As a result the IMAGEDEF remains with reference to physically deleted object.
Later this causes a crash. 

To fix the problem the sequence of removing IMAGEDEF_REACTOR is changed:
1) At first delete reference to IMAGEDEF_REACTOR from IMAGEDEF.
2) After that delete IMAGEDEF_REACTOR and remove it from objects list.

4.  Notes to Docs:

5.  Notes for Regress/Benchmarks:
New script(s) submitted: Y/N
File Name 		Module Name.
Name of Script file     Name of the module the script tests.

Script Change required: Y/N
File Name       	Sent to buildmanager@intellicad.org
Name of Script File     Y/N

6.  Change Log:
For a list of changed files, please look in http://www.itcdevelopment.org:8080/DEV/Fishbowl/CvsCommitList.  You will need a Zope id and password to access this site.
--------------------------------------------------------------------------------
Reference: Bugzilla78881       
Affected files:
2004-09-14   19:42   denisp   Source/prj/lib/SDS/sds_db.cpp?rev=1.20.4.9.2.3  
Description:  
Fixed deletion of IMAGEs.
--------------------------------------------------------------------------------

7.  System file - Component Changes and Additions
Need any system file changes in icad due to this submission (eg. files added to c:\winnt\system32)?  Please provide detail.

8.  Testing Considerations:
* Unit Test Description: Describe your unit test and your result so that we know the expected result.
* Notes for QA Testing: Notes for the QA team.

9.  Installation Issues:
Anything the members need to be aware of when creating their installers for the product.



