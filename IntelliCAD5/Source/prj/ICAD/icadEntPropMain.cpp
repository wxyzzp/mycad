// File  : <DevDir>\source\prj\icad\icadEntPropMain.cpp


//Modified Cybage MM 24-09-2001 DD-MM-YYYY [
//Reason : Bug No.- 77847 from Bugzilla
#include "configure.h"
//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]
#include "icadEntPropTabs.h"
#include "icaddialog.h"
#include "cmdsInet.h"
#include "DialogHyperlink.h"
//<alm>
#include "Modeler.h"
#include "DbAcisEntity.h"
#include "gvector.h"
using icl::point;
#include "CmdQueryTools.h"
//Bugzilla No. 7219 ; 07-10-2002
#include "dimensions.h"
//</alm>
//Modified Cybage MM 24-09-2001 DD-MM-YYYY [
//Reason : Bug No.- 77847 from Bugzilla
//#define ENT_NUM_OF_ENTITIES 25 //1 based number
#define ENT_NUM_OF_ENTITIES 26
//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]

#define ENT_3DFACE      (1<<0)
#define ENT_ARC         (1<<1)
#define ENT_ATTDEF      (1<<2)
#define ENT_ATTRIB      (1<<3)
#define ENT_CIRCLE      (1<<4)
#define ENT_DIMENSION   (1<<5)
#define ENT_ELP         (1<<6)
#define ENT_INSERT      (1<<7)
#define ENT_LEADER      (1<<8)
#define ENT_LINE        (1<<9)
#define ENT_MLINE       (1<<10)
#define ENT_MTEXT       (1<<11)
#define ENT_POLYLINE    (1<<12)
#define ENT_POINT       (1<<13)
#define ENT_RAY         (1<<14)
#define ENT_SOLID       (1<<15)
#define ENT_SPLINE      (1<<16)
#define ENT_TEXT        (1<<17)
#define ENT_TOLERANCE   (1<<18)
#define ENT_TRACE       (1<<19)
#define ENT_VIEWPORT    (1<<20)
#define ENT_XLINE       (1<<21)
#define ENT_HATCH		(1<<22)
#define ENT_LWPOLYLINE  (1<<23)
//Modified Cybage MM 24-09-2001 DD-MM-YYYY [
//Reason : Bug No.- 77847 from Bugzilla
#define ENT_IMAGE		(1<<24)
//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]
#define ENT_3DSOLID		(1<<25)
#define ENT_REGION		(1<<26)
#define ENT_BODY		(1<<27)
//Modified EBATECH(CNBR) 2002/4/24
#define ENT_SHAPE		(1<<28)


#define MAX_REAL_LEN 50

//Globals
double*			entprop_plextru;
cmd_elistll*	pVert;
cmd_elistll*	pDimItem;		/*D.G.*/// we'll use it in CMainWindow::IcadDimDia
int  LUNITS;
int  LUPREC;
int  AUNITS;
int  AUPREC;
int  num_of_splines;
int  num_of_leaders;
bool num_of_plines;
bool ent_bHitEnter;
bool bPlineIsMesh;
bool bPlineIs3D;

// EBATECH(CNBR) 31-03-2003 Bugzilla#78471 Support Lineweight

ent_DlgItem	ent_DlgItems[] =
{
//This is for 3DFACE
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 100},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 101},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 102},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 103},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 104},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 105},
    {FACE_HANDLE        , 5,RTSTR    ,  0,DB_3DFACE,0,1,0,0.0,NULL,-99,NULL,NULL, 106},
    {FACE_P1X           ,10,RT3DPOINT,  0,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 107},
    {FACE_P1Y           ,10,RT3DPOINT,  1,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 108},
    {FACE_P1Z           ,10,RT3DPOINT,  2,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 109},
    {FACE_P2X           ,11,RT3DPOINT,  0,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 110},
    {FACE_P2Y           ,11,RT3DPOINT,  1,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 111},
    {FACE_P2Z           ,11,RT3DPOINT,  2,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 112},
    {FACE_P3X           ,12,RT3DPOINT,  0,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 113},
    {FACE_P3Y           ,12,RT3DPOINT,  1,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 114},
    {FACE_P3Z           ,12,RT3DPOINT,  2,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 115},
    {FACE_P4X           ,13,RT3DPOINT,  0,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 116},
    {FACE_P4Y           ,13,RT3DPOINT,  1,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 117},
    {FACE_P4Z           ,13,RT3DPOINT,  2,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 118},
    {FACE_EDGE1         ,70,ENT_CHECK,  1,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 119},
    {FACE_EDGE2         ,70,ENT_CHECK,  2,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 120},
    {FACE_EDGE3         ,70,ENT_CHECK,  4,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 121},
    {FACE_EDGE4         ,70,ENT_CHECK,  8,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 122},
	{0				   ,210,ENT_210  , -1,DB_3DFACE,0,0,0,0.0,NULL,-99,NULL,NULL, 123},
//This is for ARC
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 200},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 201},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 202},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 203},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 204},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 205},
    {ARC_HANDLE         , 5,RTSTR    ,  0,DB_ARC ,0,1,0,0.0,NULL,-99,NULL,NULL, 206},
    {ARC_CPX            ,10,RT3DPOINT,  0,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 207},
    {ARC_CPY            ,10,RT3DPOINT,  1,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 208},
    {ARC_CPZ            ,10,RT3DPOINT,  2,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 209},
    {ARC_RADIUS         ,40,RTREAL   ,  0,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 210},
    {ARC_STARTANGLE     ,50,RTANG    ,  0,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 211},
    {ARC_ENDANGLE       ,51,RTANG    ,  0,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 212},
	{0				   ,210,ENT_210  ,  0,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 213},
	{0				   ,210,ENT_210  ,  1,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 214},
	{0				   ,210,ENT_210  ,  2,DB_ARC ,0,0,0,0.0,NULL,-99,NULL,NULL, 215},
//This is for ATTDEF
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 300},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 301},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 302},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 303},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 304},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 305},
//  {ATTD_HANDLE        , 5,RTSTR    ,  0,DB_ATTDEF,0,1,0,0.0,NULL,-99,NULL,NULL, 306},
    {ATTD_TAG           , 2,RTSTR    ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 307},
    {ATTD_PROMPT        , 3,RTSTR    ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 308},
    {ATTD_VALUE         , 1,RTSTR    ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 309},
    {ATTD_SPX           ,10,RT3DPOINT,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 310},
    {ATTD_SPY           ,10,RT3DPOINT,  1,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 311},
    {ATTD_SPZ           ,10,RT3DPOINT,  2,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 312},
    {ATTD_APX           ,11,RT3DPOINT,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 313},
    {ATTD_APY           ,11,RT3DPOINT,  1,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 314},
    {ATTD_APZ           ,11,RT3DPOINT,  2,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 315},
    {ATTD_HEIGHT        ,40,RTREAL   ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 316},
    {ATTD_ROTATE        ,50,RTANG    ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 317},
    {ATTD_OBLIQUE       ,51,RTANG    ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 318},
    {ATTD_THICK         ,39,RTREAL   ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 319},
    {ATTD_SCALE         ,41,RTREAL   ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 320},
    {ATTD_INVISISIBLE   ,70,ENT_CHECK,  1,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 321},
    {ATTD_CONSTANT      ,70,ENT_CHECK,  2,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 322},
    {ATTD_VERIFY        ,70,ENT_CHECK,  4,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 323},
    {ATTD_PRESET        ,70,ENT_CHECK,  8,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 324},
    {ATTD_STYLE         , 7,RTSTR    ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 325},
    {ATTD_BACKWARD      ,71,ENT_CHECK,  2,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 326},
    {ATTD_UPSIDEDOWN    ,71,ENT_CHECK,  4,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 327},
    {0                  ,72,ENT_JUSTI,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 328},
    {0                  ,74,ENT_JUSTI,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 329},
	{0				   ,210,ENT_210  ,  0,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 330},
	{0				   ,210,ENT_210  ,  1,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 331},
	{0				   ,210,ENT_210  ,  2,DB_ATTDEF,0,0,0,0.0,NULL,-99,NULL,NULL, 332},
//This is for ATTRIBS
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 400},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 401},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 402},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 403},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 404},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 405},
//  {ATTR_HANDLE        , 5,RTSTR    ,  0,DB_ATTRIB,0,1,0,0.0,NULL,-99,NULL,NULL, 406},
    {ATTR_TAG           , 2,RTSTR    ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 408},
    {ATTR_VALUE         , 1,RTSTR    ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 409},
    {ATTR_SPX           ,10,RT3DPOINT,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 410},
    {ATTR_SPY           ,10,RT3DPOINT,  1,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 411},
    {ATTR_SPZ           ,10,RT3DPOINT,  2,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 412},
    {ATTR_APX           ,11,RT3DPOINT,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 413},
    {ATTR_APY           ,11,RT3DPOINT,  1,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 414},
    {ATTR_APZ           ,11,RT3DPOINT,  2,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 415},
    {ATTR_HEIGHT        ,40,RTREAL   ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 416},
    {ATTR_ROTATE        ,50,RTANG    ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 417},
    {ATTR_OBLIQUE       ,51,RTANG    ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 418},
    {ATTR_THICK         ,39,RTREAL   ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 419},
    {ATTR_SCALE         ,41,RTREAL   ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 420},
    {ATTR_INVISISIBLE   ,70,ENT_CHECK,  1,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 421},
    {ATTR_CONSTANT      ,70,ENT_CHECK,  2,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 422},
    {ATTR_VERIFY        ,70,ENT_CHECK,  4,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 423},
    {ATTR_PRESET        ,70,ENT_CHECK,  8,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 424},
    {ATTR_STYLE         , 7,RTSTR    ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 425},
    {ATTR_BACKWARD      ,71,ENT_CHECK,  2,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 426},
    {ATTR_UPSIDEDOWN    ,71,ENT_CHECK,  4,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 427},
    {0                  ,72,ENT_JUSTI,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 428},
    {0                  ,74,ENT_JUSTI,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 429},
	{0				   ,210,ENT_210  ,  0,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 430},
	{0				   ,210,ENT_210  ,  1,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 431},
	{0				   ,210,ENT_210  ,  2,DB_ATTRIB,0,0,0,0.0,NULL,-99,NULL,NULL, 432},
//This is for CIRCLE
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 500},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 501},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 502},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 503},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 504},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 505},
    {CIRCLE_HANDLE      , 5,RTSTR    ,  0,DB_CIRCLE,0,1,0,0.0,NULL,-99,NULL,NULL, 506},
    {CIRCLE_CPX         ,10,RT3DPOINT,  0,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 507},
    {CIRCLE_CPY         ,10,RT3DPOINT,  1,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 508},
    {CIRCLE_CPZ         ,10,RT3DPOINT,  2,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 509},
    {CIRCLE_RADIUS      ,40,RTREAL   ,  0,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 510},
	{0				   ,210,ENT_210  ,  0,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 511},
	{0				   ,210,ENT_210  ,  1,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 512},
	{0				   ,210,ENT_210  ,  2,DB_CIRCLE,0,0,0,0.0,NULL,-99,NULL,NULL, 513},
//This is for DIMENSION
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 600},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 601},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 602},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 603},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 604},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 605},
    {DIM_HANDLE         , 5,RTSTR    ,  0,DB_DIMENSION,0,1,0,0.0,NULL,-99,NULL,NULL, 606},
    {DIM_DISP           , 1,RTSTR    ,  0,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 607},
    {DIM_IPX            ,10,RT3DPOINT,  0,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 608},
    {DIM_IPY            ,10,RT3DPOINT,  1,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 609},
    {DIM_IPZ            ,10,RT3DPOINT,  2,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 610},
    {DIM_ROTATION       ,50,RTANG    ,  0,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 611},
    {DIM_STYLE          , 3,RTSTR    ,  0,DB_DIMENSION,0,1,0,0.0,NULL,-99,NULL,NULL, 612},	/*D.G.*/// Set read-only.
	{0				   ,210,ENT_210  ,  0,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 613},
	{0				   ,210,ENT_210  ,  1,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 614},
	{0				   ,210,ENT_210  ,  2,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 615},
	{DIM_TYPE			,70,DIME_TYPE,	0,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 616}, 	//Bugzilla No. 7219 ; 07-10-2002
	{DIM_MEASUREMENT	,42,DIM_MEASURE,0,DB_DIMENSION,0,0,0,0.0,NULL,-99,NULL,NULL, 617}, 	//Bugzilla No. 7219 ; 07-10-2002
	
	
//This is for ELLIPSE
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 700},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 701},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 702},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 703},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 704},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 705},
    {ELP_HANDLE         , 5,RTSTR    ,  0,DB_ELLIPSE,0,1,0,0.0,NULL,-99,NULL,NULL, 706},
    {ELP_STX            ,10,RT3DPOINT,  0,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 707},
    {ELP_STY            ,10,RT3DPOINT,  1,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 708},
    {ELP_STZ            ,10,RT3DPOINT,  2,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 706},
    {ELP_EPX            ,11,RT3DPOINT,  0,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 707},
    {ELP_EPY            ,11,RT3DPOINT,  1,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 708},
    {ELP_EPZ            ,11,RT3DPOINT,  2,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 709},
    {ELP_RATIO          ,40,RTREAL   ,  0,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 710},
    {ELP_START          ,41,RTANG    ,  0,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 711},
    {ELP_END            ,42,RTANG_END,  0,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 712},
	{0				   ,210,ENT_210  , -1,DB_ELLIPSE,0,0,0,0.0,NULL,-99,NULL,NULL, 713},
    //Modified Cybage MM 24-09-2001 DD-MM-YYYY [
	//Reason : Bug No.- 77847 from Bugzilla
//This is for IMAGE
	{GEN_LAYER          , 8,RTSTR    ,  0,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 750},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 751},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 752},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 753},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 755},
    {IMAGE_HANDLE       , 5,RTSTR    ,  0,DB_IMAGE,0,1,0,0.0,NULL,-99,NULL,NULL, 756},
	#ifdef BUILD_WITH_RASTER_SUPPORT
    {IMAGE_OPX          ,10,RT3DPOINT,  0,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 757},
    {IMAGE_OPY          ,10,RT3DPOINT,  1,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 758},
    {IMAGE_OPZ          ,10,RT3DPOINT,  2,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 759},
	{IMAGE_SHOW_IMAGE   ,70,ENT_CHECK,  1,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 760},
    {IMAGE_NON_ORTHO    ,70,ENT_CHECK,  2,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 761},
    {IMAGE_SHOW_CLIPPED ,70,ENT_CHECK,  4,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 762},
    {IMAGE_TRANSPARENCY ,70,ENT_CHECK,  8,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 763},
	{IMAGE_BRIGHTNESS  ,281,RTSHORT  ,  0,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 764},
	{IMAGE_CONTRAST    ,282,RTSHORT  ,  0,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 765},
	{IMAGE_FADE        ,283,RTSHORT  ,  0,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 766},
	#endif
    {0				   ,210,ENT_210  , -1,DB_IMAGE,0,0,0,0.0,NULL,-99,NULL,NULL, 767},
	//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]
//This is for INSERTS
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 800},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 801},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 802},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 803},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 804},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 805},
    {INSERT_HANDLE      , 5,RTSTR    ,  0,DB_INSERT,0,1,0,0.0,NULL,-99,NULL,NULL, 806},
    {INSERT_NAME        , 2,RTSTR    ,  0,DB_INSERT,0,1,0,0.0,NULL,-99,NULL,NULL, 807},
    {INSERT_IPX         ,10,RT3DPOINT,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 808},
    {INSERT_IPY         ,10,RT3DPOINT,  1,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 809},
    {INSERT_IPZ         ,10,RT3DPOINT,  2,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 810},
    {INSERT_SFX         ,41,RTREAL   ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 811},
    {INSERT_SFY         ,42,RTREAL   ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 812},
    {INSERT_SFZ         ,43,RTREAL   ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 813},
    {INSERT_COLUMNS     ,70,RTSHORT  ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 815},
    {INSERT_COLSPACE    ,44,RTREAL   ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 816},
    {INSERT_ROTATION    ,50,RTANG    ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 817},
    {INSERT_ROWS        ,71,RTSHORT  ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 818},
    {INSERT_ROWSPACE    ,45,RTREAL   ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 819},
	{0				   ,210,ENT_210  ,  0,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 820},
	{0				   ,210,ENT_210  ,  1,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 821},
	{0				   ,210,ENT_210  ,  2,DB_INSERT,0,0,0,0.0,NULL,-99,NULL,NULL, 822},
//This is for LEADER
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_LEADER,0,0,0,0.0,NULL,-99,NULL,NULL, 900},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_LEADER,0,0,0,0.0,NULL,-99,NULL,NULL, 901},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_LEADER,0,0,0,0.0,NULL,-99,NULL,NULL, 902},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_LEADER,0,0,0,0.0,NULL,-99,NULL,NULL, 903},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_LEADER,0,0,0,0.0,NULL,-99,NULL,NULL, 904},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_LEADER,0,0,0,0.0,NULL,-99,NULL,NULL, 905},
    {LEADER_HANDLE      , 5,RTSTR    ,  0,DB_LEADER,0,1,0,0.0,NULL,-99,NULL,NULL, 906},
    {LEADER_SPLINE      ,72,ENT_CHECK,  1,DB_LEADER,0,0,0,0.0,NULL,-99,NULL,NULL,1113},
    {LEADER_HEAD        ,71,ENT_CHECK,  1,DB_LEADER,0,0,0,0.0,NULL,-99,NULL,NULL,1113},
    {LEADER_X           ,10,RT3DPOINT,  0,DB_LEADER,0,0,0,0.0,NULL,-99,NULL,NULL,1407},
    {LEADER_Y           ,10,RT3DPOINT,  1,DB_LEADER,0,0,0,0.0,NULL,-99,NULL,NULL,1407},
    {LEADER_Z           ,10,RT3DPOINT,  2,DB_LEADER,0,0,0,0.0,NULL,-99,NULL,NULL,1408},
//This is for LINE
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 900},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 901},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 902},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 903},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 904},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 905},
    {LINE_HANDLE        , 5,RTSTR    ,  0,DB_LINE,0,1,0,0.0,NULL,-99,NULL,NULL, 906},
    {LINE_STX           ,10,RT3DPOINT,  0,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 907},
    {LINE_STY           ,10,RT3DPOINT,  1,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 908},
    {LINE_STZ           ,10,RT3DPOINT,  2,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 909},
    {LINE_EDX           ,11,RT3DPOINT,  0,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 910},
    {LINE_EDY           ,11,RT3DPOINT,  1,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 911},
    {LINE_EDZ           ,11,RT3DPOINT,  2,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 912},
	{0				   ,210,ENT_210  , -1,DB_LINE,0,0,0,0.0,NULL,-99,NULL,NULL, 913},
//This is for MLINE
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_MLINE,0,0,0,0.0,NULL,-99,NULL,NULL, 900},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_MLINE,0,0,0,0.0,NULL,-99,NULL,NULL, 901},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_MLINE,0,0,0,0.0,NULL,-99,NULL,NULL, 902},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_MLINE,0,0,0,0.0,NULL,-99,NULL,NULL, 903},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_MLINE,0,0,0,0.0,NULL,-99,NULL,NULL, 904},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_MLINE,0,0,0,0.0,NULL,-99,NULL,NULL, 905},
    {MLINE_HANDLE       , 5,RTSTR    ,  0,DB_MLINE,0,1,0,0.0,NULL,-99,NULL,NULL, 906},
//This is for MTEXT
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 900},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 901},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 902},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 903},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 904},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 905},
    {MTEXT_HANDLE       , 5,RTSTR    ,  0,DB_MTEXT,0,1,0,0.0,NULL,-99,NULL,NULL, 906},
    {MTEXT_ORIGIN_X     ,10,RT3DPOINT,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 907},
    {MTEXT_ORIGIN_Y     ,10,RT3DPOINT,  1,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 908},
    {MTEXT_ORIGIN_Z     ,10,RT3DPOINT,  2,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 909},
    {MTEXT_ROTATION     ,50,RTANG    ,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 910},
    {MTEXT_HEIGHT       ,40,RTREAL   ,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 911},
    {MTEXT_WIDTH        ,41,RTREAL   ,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 912},
    {MTEXT_TEXT         , 1,RTSTR    ,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 913},
    {MTEXT_STYLE        , 7,RTSTR    ,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 914},
    {MTEXT_JUSTIFY      ,71,ENT_COMBO,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 915},
    {MTEXT_DIRECTION    ,72,ENT_COMBO,  0,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 916},
	{0				   ,210,ENT_210  , -1,DB_MTEXT,0,0,0,0.0,NULL,-99,NULL,NULL, 917},
//This is for POINTS
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_POINT,0,0,0,0.0,NULL,-99,NULL,NULL,1000},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_POINT,0,0,0,0.0,NULL,-99,NULL,NULL,1001},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_POINT,0,0,0,0.0,NULL,-99,NULL,NULL,1002},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_POINT,0,0,0,0.0,NULL,-99,NULL,NULL,1003},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_POINT,0,0,0,0.0,NULL,-99,NULL,NULL,1004},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_POINT,0,0,0,0.0,NULL,-99,NULL,NULL,1005},
    {POINT_HANDLE       , 5,RTSTR    ,  0,DB_POINT,0,1,0,0.0,NULL,-99,NULL,NULL,1006},
    {POINT_CPX          ,10,RT3DPOINT,  0,DB_POINT,0,0,0,0.0,NULL,-99,NULL,NULL,1007},
    {POINT_CPY          ,10,RT3DPOINT,  1,DB_POINT,0,0,0,0.0,NULL,-99,NULL,NULL,1008},
    {POINT_CPZ          ,10,RT3DPOINT,  2,DB_POINT,0,0,0,0.0,NULL,-99,NULL,NULL,1009},
    {POINT_ANG          ,50,RTANG    ,  0,DB_POINT,0,0,0,0.0,NULL,-99,NULL,NULL,1010},
	{0				   ,210,ENT_210  , -1,DB_POINT,0,0,0,0.0,NULL,-99,NULL,NULL,1011},
//This is for POLYLINES
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1100},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1101},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1102},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1103},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1104},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1105},
    {PLINE_HANDLE       , 5,RTSTR    ,  0,DB_POLYLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1106},
    {PLINE_MESHM        ,71,RTSHORT  ,  0,DB_POLYLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1107},
    {PLINE_MESHN        ,72,RTSHORT  ,  0,DB_POLYLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1108},
    {PLINE_SMOOTHM      ,73,RTSHORT  ,  0,DB_POLYLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1109},
    {PLINE_SMOOTHN      ,74,RTSHORT  ,  0,DB_POLYLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1113},
    {PLINE_PFLAG_8      ,70,ENT_CHECK,  8,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1115}, //not displayed
    {PLINE_MESH         ,70,ENT_CHECK, 16,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1116}, //not displayed
    {PLINE_PFLAG_1      ,70,ENT_CHECK,  1,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1117},
    {PLINE_PFLAG_128    ,70,ENT_CHECK,128,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1118},
    {PLINE_ELEV         ,10,RT3DPOINT,  0,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1119},//dummy, not used
    {PLINE_ELEV         ,10,RT3DPOINT,  1,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1120},//dummy, not used
    {PLINE_ELEV         ,10,RT3DPOINT,  2,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1121},
	{0				   ,210,ENT_210  ,  0,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1122},
	{0				   ,210,ENT_210  ,  1,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1123},
	{0				   ,210,ENT_210  ,  2,DB_POLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1124},
//This is for POLYLINE VERTICES  this is not for a tab
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1100},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1101},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1102},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1103},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1104},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1105},
    {PVERT_HANDLE       , 5,RTSTR    ,  0,DB_VERTEX,0,1,0,0.0,NULL,-99,NULL,NULL,1106},
//  {PVERT_X            ,10,RT3DPOINT,  0,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1201},
//  {PVERT_Y            ,10,RT3DPOINT,  1,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1202},
//  {PVERT_Z            ,10,RT3DPOINT,  2,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1203},
    {PVERT_ST_WIDTH     ,40,RTREAL   ,  0,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1204},
    {PVERT_ED_WIDTH     ,41,RTREAL   ,  0,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1205},
    {PVERT_BULGE        ,42,RTREAL   ,  0,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1206},
    {PLINE_PFLAG_8      ,70,ENT_CHECK, 32,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1207},
	{0				   ,210,ENT_210  ,  0,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1208},
	{0				   ,210,ENT_210  ,  1,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1209},
	{0				   ,210,ENT_210  ,  2,DB_VERTEX,0,0,0,0.0,NULL,-99,NULL,NULL,1210},
//This is for SEQEND  this is not for a tab
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_SEQEND,0,0,0,0.0,NULL,-99,NULL,NULL,1100},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_SEQEND,0,0,0,0.0,NULL,-99,NULL,NULL,1101},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_SEQEND,0,0,0,0.0,NULL,-99,NULL,NULL,1102},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_SEQEND,0,0,0,0.0,NULL,-99,NULL,NULL,1103},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_SEQEND,0,0,0,0.0,NULL,-99,NULL,NULL,1104},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_SEQEND,0,0,0,0.0,NULL,-99,NULL,NULL,1105},
//This is for LWPOLYLINES
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_LWPOLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1100},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_LWPOLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1101},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_LWPOLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1102},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_LWPOLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1103},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_LWPOLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1104},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_LWPOLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1105},
    {PLINE_HANDLE       , 5,RTSTR    ,  0,DB_LWPOLYLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1116},
    {PLINE_PFLAG_1      ,70,ENT_CHECK,  1,DB_LWPOLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1117},
    {PLINE_PFLAG_128    ,70,ENT_CHECK,128,DB_LWPOLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1118},
//  {PLINE_ELEV         ,10,RT3DPOINT,  0,DB_LWPOLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1119},//dummy, not used
//  {PLINE_ELEV         ,10,RT3DPOINT,  1,DB_LWPOLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1120},//dummy, not used
    {PLINE_ELEV         ,38,RTREAL   ,  0,DB_LWPOLYLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1121},
//This is for RAY
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1300},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1301},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1302},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1303},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1304},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1305},
    {RAY_HANDLE         , 5,RTSTR    ,  0,DB_RAY ,0,1,0,0.0,NULL,-99,NULL,NULL,1306},
    {RAY_STX            ,10,RT3DPOINT,  0,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1307},
    {RAY_STY            ,10,RT3DPOINT,  1,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1308},
    {RAY_STZ            ,10,RT3DPOINT,  2,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1309},
    {RAY_EDX            ,11,RT3DPOINT,  0,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1310},
    {RAY_EDY            ,11,RT3DPOINT,  1,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1311},
    {RAY_EDZ            ,11,RT3DPOINT,  2,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1312},
	{0				   ,210,ENT_210  , -1,DB_RAY ,0,0,0,0.0,NULL,-99,NULL,NULL,1313},
//This is for SHAPE // EBATECH(CNBR) 2002/4/24
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1500},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1501},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1502},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1503},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1504},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1505},
    {SHAPE_HANDLE       , 5,RTSTR    ,  0,DB_SHAPE,0,1,0,0.0,NULL,-99,NULL,NULL,1506},
    {SHAPE_ORIGIN_X     ,10,RT3DPOINT,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1507},
    {SHAPE_ORIGIN_Y     ,10,RT3DPOINT,  1,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1508},
    {SHAPE_ORIGIN_Z     ,10,RT3DPOINT,  2,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1509},
    {SHAPE_HEIGHT       ,40,RTREAL   ,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1510},
    {SHAPE_ROTATION     ,50,RTANG    ,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1511},
    {SHAPE_WIDTH        ,41,RTREAL   ,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1512},
    {SHAPE_OBLIQUE      ,51,RTANG    ,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1514},
    {SHAPE_NAME         , 2,RTSTR    ,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1515},
	{0				   ,210,ENT_210  ,  0,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1516},
	{0				   ,210,ENT_210  ,  1,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1517},
	{0				   ,210,ENT_210  ,  2,DB_SHAPE,0,0,0,0.0,NULL,-99,NULL,NULL,1518},
//This is for SOLID
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1400},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1401},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1402},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1403},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1404},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1405},
    {SOLID_HANDLE       , 5,RTSTR    ,  0,DB_SOLID,0,1,0,0.0,NULL,-99,NULL,NULL,1415},
    {SOLID_P4X          ,13,RT3DPOINT,  0,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1416},
    {SOLID_P4Y          ,13,RT3DPOINT,  1,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1417},
    {SOLID_P4Z          ,13,RT3DPOINT,  2,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1406},
    {SOLID_P1X          ,10,RT3DPOINT,  0,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1407},
    {SOLID_P1Y          ,10,RT3DPOINT,  1,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1408},
    {SOLID_P1Z          ,10,RT3DPOINT,  2,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1409},
    {SOLID_P2X          ,11,RT3DPOINT,  0,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1410},
    {SOLID_P2Y          ,11,RT3DPOINT,  1,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1411},
    {SOLID_P2Z          ,11,RT3DPOINT,  2,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1412},
    {SOLID_P3X          ,12,RT3DPOINT,  0,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1413},
    {SOLID_P3Y          ,12,RT3DPOINT,  1,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1414},
    {SOLID_P3Z          ,12,RT3DPOINT,  2,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1418},
	{0				   ,210,ENT_210  ,  0,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1419},
	{0				   ,210,ENT_210  ,  1,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1420},
	{0				   ,210,ENT_210  ,  2,DB_SOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1421},
//This is for SPLINE
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_SPLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1400},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_SPLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1401},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_SPLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1402},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_SPLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1403},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_SPLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1404},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_SPLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1405},
    {SPLINE_HANDLE      , 5,RTSTR    ,  0,DB_SPLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1406},
    {SPLINE_DEG         ,71,RTSHORT  ,  0,DB_SPLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1406},
    {SPLINE_FLAG1       ,70,ENT_GREY ,  1,DB_SPLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1406},
    {SPLINE_FLAG2       ,70,ENT_GREY ,  2,DB_SPLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1406},
    {SPLINE_FLAG4       ,70,ENT_GREY ,  4,DB_SPLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1406},
    {SPLINE_FLAG8       ,70,ENT_GREY ,  8,DB_SPLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1406},
    {SPLINE_FLAG16      ,70,ENT_GREY , 16,DB_SPLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1407},
    {SPLINE_CTL_X       ,10,RT3DPOINT,  0,DB_SPLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1407},
    {SPLINE_CTL_Y       ,10,RT3DPOINT,  1,DB_SPLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1408},
    {SPLINE_CTL_Z       ,10,RT3DPOINT,  2,DB_SPLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1409},
    {SPLINE_FIT_X       ,11,RT3DPOINT,  0,DB_SPLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1410},
    {SPLINE_FIT_Y       ,11,RT3DPOINT,  1,DB_SPLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1411},
    {SPLINE_FIT_Z       ,11,RT3DPOINT,  2,DB_SPLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1412},

//This is for TEXT
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1500},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1501},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1502},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1503},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1504},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1505},
    {TEXT_HANDLE        , 5,RTSTR    ,  0,DB_TEXT,0,1,0,0.0,NULL,-99,NULL,NULL,1506},
    {TEXT_ORIGIN_X      ,10,RT3DPOINT,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1507},
    {TEXT_ORIGIN_Y      ,10,RT3DPOINT,  1,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1508},
    {TEXT_ORIGIN_Z      ,10,RT3DPOINT,  2,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1509},
    {TEXT_ALIGN_X       ,11,RT3DPOINT,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1510},
    {TEXT_ALIGN_Y       ,11,RT3DPOINT,  1,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1511},
    {TEXT_ALIGN_Z       ,11,RT3DPOINT,  2,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1512},
    {TEXT_HEIGHT        ,40,RTREAL   ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1513},
    {TEXT_ROTATION      ,50,RTANG    ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1514},
    {TEXT_WIDTH         ,41,RTREAL   ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1515},
    {TEXT_OBLIQUE       ,51,RTANG    ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1516},
    {TEXT_TEXT          , 1,RTSTR    ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1517},
    {TEXT_STYLE         , 7,RTSTR    ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1518},
    {TEXT_GENERATION1   ,71,ENT_CHECK,  2,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1519},
    {TEXT_GENERATION2   ,71,ENT_CHECK,  4,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1520},
    {0                  ,72,ENT_JUSTI,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1521},
    {0                  ,73,ENT_JUSTI,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1522},
	{0				   ,210,ENT_210  ,  0,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1523},
	{0				   ,210,ENT_210  ,  1,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1524},
	{0				   ,210,ENT_210  ,  2,DB_TEXT,0,0,0,0.0,NULL,-99,NULL,NULL,1525},
//This is for TOLERANCE
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_TOLERANCE,0,0,0,0.0,NULL,-99,NULL,NULL,1550},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_TOLERANCE,0,0,0,0.0,NULL,-99,NULL,NULL,1551},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_TOLERANCE,0,0,0,0.0,NULL,-99,NULL,NULL,1552},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_TOLERANCE,0,0,0,0.0,NULL,-99,NULL,NULL,1553},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_TOLERANCE,0,0,0,0.0,NULL,-99,NULL,NULL,1554},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_TOLERANCE,0,0,0,0.0,NULL,-99,NULL,NULL,1555},
    {TOLE_HANDLE        , 5,RTSTR    ,  0,DB_TOLERANCE,0,1,0,0.0,NULL,-99,NULL,NULL,1556},
    {TOLE_STX           ,10,RT3DPOINT,  0,DB_TOLERANCE,0,0,0,0.0,NULL,-99,NULL,NULL,1557},
    {TOLE_STY           ,10,RT3DPOINT,  1,DB_TOLERANCE,0,0,0,0.0,NULL,-99,NULL,NULL,1558},
    {TOLE_STZ           ,10,RT3DPOINT,  2,DB_TOLERANCE,0,0,0,0.0,NULL,-99,NULL,NULL,1559},
	{0				   ,210,ENT_210  ,  0,DB_TOLERANCE,0,0,0,0.0,NULL,-99,NULL,NULL,1560},
	{0				   ,210,ENT_210  ,  1,DB_TOLERANCE,0,0,0,0.0,NULL,-99,NULL,NULL,1561},
	{0				   ,210,ENT_210  ,  2,DB_TOLERANCE,0,0,0,0.0,NULL,-99,NULL,NULL,1562},
//This is for TRACE
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1600},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1601},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1602},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1603},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1604},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1605},
    {TRACE_HANDLE       , 5,RTSTR    ,  0,DB_TRACE,0,1,0,0.0,NULL,-99,NULL,NULL,1606},
    {TRACE_P1X          ,10,RT3DPOINT,  0,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1607},
    {TRACE_P1Y          ,10,RT3DPOINT,  1,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1608},
    {TRACE_P1Z          ,10,RT3DPOINT,  2,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1609},
    {TRACE_P2X          ,11,RT3DPOINT,  0,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1610},
    {TRACE_P2Y          ,11,RT3DPOINT,  1,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1611},
    {TRACE_P2Z          ,11,RT3DPOINT,  2,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1612},
    {TRACE_P3X          ,12,RT3DPOINT,  0,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1613},
    {TRACE_P3Y          ,12,RT3DPOINT,  1,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1614},
    {TRACE_P3Z          ,12,RT3DPOINT,  2,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1615},
    {TRACE_P4X          ,13,RT3DPOINT,  0,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1616},
    {TRACE_P4Y          ,13,RT3DPOINT,  1,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1617},
    {TRACE_P4Z          ,13,RT3DPOINT,  2,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1618},
	{0				   ,210,ENT_210  ,  0,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1619},
	{0				   ,210,ENT_210  ,  1,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1620},
	{0				   ,210,ENT_210  ,  2,DB_TRACE,0,0,0,0.0,NULL,-99,NULL,NULL,1621},
//This is for VIEWPORTS
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_VIEWPORT,0,0,0,0.0,NULL,-99,NULL,NULL,1550},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_VIEWPORT,0,0,0,0.0,NULL,-99,NULL,NULL,1551},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_VIEWPORT,0,0,0,0.0,NULL,-99,NULL,NULL,1552},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_VIEWPORT,0,0,0,0.0,NULL,-99,NULL,NULL,1553},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_VIEWPORT,0,0,0,0.0,NULL,-99,NULL,NULL,1554},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_VIEWPORT,0,0,0,0.0,NULL,-99,NULL,NULL,1555},
    {VIEWP_HANDLE       , 5,RTSTR    ,  0,DB_VIEWPORT,0,1,0,0.0,NULL,-99,NULL,NULL,1556},
    {VIEWP_CPX          ,10,RT3DPOINT,  0,DB_VIEWPORT,0,0,0,0.0,NULL,-99,NULL,NULL,1557},
    {VIEWP_CPY          ,10,RT3DPOINT,  1,DB_VIEWPORT,0,0,0,0.0,NULL,-99,NULL,NULL,1558},
    {VIEWP_CPZ          ,10,RT3DPOINT,  2,DB_VIEWPORT,0,0,0,0.0,NULL,-99,NULL,NULL,1559},
    {VIEWP_WIDTH        ,40,RT3DPOINT,  0,DB_VIEWPORT,0,0,0,0.0,NULL,-99,NULL,NULL,1560},
    {VIEWP_HEIGHT       ,41,RT3DPOINT,  0,DB_VIEWPORT,0,0,0,0.0,NULL,-99,NULL,NULL,1561},
//This is for XLINE
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1700},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1701},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1702},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1703},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1704},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1705},
    {XLINE_HANDLE       , 5,RTSTR    ,  0,DB_XLINE,0,1,0,0.0,NULL,-99,NULL,NULL,1706},
    {XLINE_STX          ,10,RT3DPOINT,  0,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1707},
    {XLINE_STY          ,10,RT3DPOINT,  1,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1708},
    {XLINE_STZ          ,10,RT3DPOINT,  2,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1709},
    {XLINE_EDX          ,11,RT3DPOINT,  0,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1710},
    {XLINE_EDY          ,11,RT3DPOINT,  1,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1711},
    {XLINE_EDZ          ,11,RT3DPOINT,  2,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1712},
	{0				   ,210,ENT_210  , -1,DB_XLINE,0,0,0,0.0,NULL,-99,NULL,NULL,1713},
//HATCH
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_HATCH,0,0,0,0.0,NULL,-99,NULL,NULL,1800},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_HATCH,0,0,0,0.0,NULL,-99,NULL,NULL,1801},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_HATCH,0,0,0,0.0,NULL,-99,NULL,NULL,1802},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_HATCH,0,0,0,0.0,NULL,-99,NULL,NULL,1803},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_HATCH,0,0,0,0.0,NULL,-99,NULL,NULL,1804},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_HATCH,0,0,0,0.0,NULL,-99,NULL,NULL,1805},
    {HATCH_HANDLE       , 5,RTSTR    ,  0,DB_HATCH,0,1,0,0.0,NULL,-99,NULL,NULL,1806},
	{0				   ,210,ENT_210  , -1,DB_HATCH,0,0,0,0.0,NULL,-99,NULL,NULL,1807},
//3DSOLID ENTITY
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_3DSOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1900},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_3DSOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1901},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_3DSOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1902},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_3DSOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1903},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_3DSOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1904},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_3DSOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1905},
	{ACIS_BOUNDBOXMINX	,13,RT3DPOINT,	0,DB_3DSOLID,0,1,0,0.0,NULL,-99,NULL,NULL,1910},
	{ACIS_BOUNDBOXMINY	,13,RT3DPOINT,	1,DB_3DSOLID,0,1,0,0.0,NULL,-99,NULL,NULL,1911},
	{ACIS_BOUNDBOXMINZ	,13,RT3DPOINT,	2,DB_3DSOLID,0,1,0,0.0,NULL,-99,NULL,NULL,1912},
	{ACIS_BOUNDBOXMAXX	,13,RT3DPOINT,	0,DB_3DSOLID,0,1,0,0.0,NULL,-99,NULL,NULL,1910},
	{ACIS_BOUNDBOXMAXY	,13,RT3DPOINT,	1,DB_3DSOLID,0,1,0,0.0,NULL,-99,NULL,NULL,1911},
	{ACIS_BOUNDBOXMAXZ	,13,RT3DPOINT,	2,DB_3DSOLID,0,1,0,0.0,NULL,-99,NULL,NULL,1912},
	{ACIS_HANDLE        , 5,RTSTR    ,  0,DB_3DSOLID,0,1,0,0.0,NULL,-99,NULL,NULL,1905},
	{0				   ,210,ENT_210  , -1,DB_3DSOLID,0,0,0,0.0,NULL,-99,NULL,NULL,1913},
//REGION ENTITY
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_REGION,0,0,0,0.0,NULL,-99,NULL,NULL,1900},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_REGION,0,0,0,0.0,NULL,-99,NULL,NULL,1901},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_REGION,0,0,0,0.0,NULL,-99,NULL,NULL,1902},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_REGION,0,0,0,0.0,NULL,-99,NULL,NULL,1903},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_REGION,0,0,0,0.0,NULL,-99,NULL,NULL,1904},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_REGION,0,0,0,0.0,NULL,-99,NULL,NULL,1905},
	{ACIS_BOUNDBOXMINX	,13,RT3DPOINT,	0,DB_REGION,0,1,0,0.0,NULL,-99,NULL,NULL,1910},
	{ACIS_BOUNDBOXMINY	,13,RT3DPOINT,	1,DB_REGION,0,1,0,0.0,NULL,-99,NULL,NULL,1911},
	{ACIS_BOUNDBOXMINZ	,13,RT3DPOINT,	2,DB_REGION,0,1,0,0.0,NULL,-99,NULL,NULL,1912},
	{ACIS_BOUNDBOXMAXX	,13,RT3DPOINT,	0,DB_REGION,0,1,0,0.0,NULL,-99,NULL,NULL,1910},
	{ACIS_BOUNDBOXMAXY	,13,RT3DPOINT,	1,DB_REGION,0,1,0,0.0,NULL,-99,NULL,NULL,1911},
	{ACIS_BOUNDBOXMAXZ	,13,RT3DPOINT,	2,DB_REGION,0,1,0,0.0,NULL,-99,NULL,NULL,1912},
	{ACIS_HANDLE        , 5,RTSTR    ,  0,DB_REGION,0,1,0,0.0,NULL,-99,NULL,NULL,1905},
	{0				   ,210,ENT_210  , -1,DB_REGION,0,0,0,0.0,NULL,-99,NULL,NULL,1906},
//BODY ENTITY
    {GEN_LAYER          , 8,RTSTR    ,  0,DB_BODY,0,0,0,0.0,NULL,-99,NULL,NULL,1900},
    {GEN_LINETYPE       , 6,RTSTR    ,  0,DB_BODY,0,0,0,0.0,NULL,-99,NULL,NULL,1901},
    {GEN_LTSCALE        ,48,RTREAL   ,  0,DB_BODY,0,0,0,0.0,NULL,-99,NULL,NULL,1902},
    {GEN_THICKNESS      ,39,RTREAL   ,  0,DB_BODY,0,0,0,0.0,NULL,-99,NULL,NULL,1903},
    {GEN_COLOR          ,62,ENT_COL  ,  0,DB_BODY,0,0,0,0.0,NULL,-99,NULL,NULL,1904},
    {GEN_LW            ,370,ENT_LW   ,  0,DB_BODY,0,0,0,0.0,NULL,-99,NULL,NULL,1905},
	{ACIS_BOUNDBOXMINX	,13,RT3DPOINT,	0,DB_BODY,0,1,0,0.0,NULL,-99,NULL,NULL,1910},
	{ACIS_BOUNDBOXMINY	,13,RT3DPOINT,	1,DB_BODY,0,1,0,0.0,NULL,-99,NULL,NULL,1911},
	{ACIS_BOUNDBOXMINZ	,13,RT3DPOINT,	2,DB_BODY,0,1,0,0.0,NULL,-99,NULL,NULL,1912},
	{ACIS_BOUNDBOXMAXX	,13,RT3DPOINT,	0,DB_BODY,0,1,0,0.0,NULL,-99,NULL,NULL,1910},
	{ACIS_BOUNDBOXMAXY	,13,RT3DPOINT,	1,DB_BODY,0,1,0,0.0,NULL,-99,NULL,NULL,1911},
	{ACIS_BOUNDBOXMAXZ	,13,RT3DPOINT,	2,DB_BODY,0,1,0,0.0,NULL,-99,NULL,NULL,1912},
	{ACIS_HANDLE        , 5,RTSTR    ,  0,DB_BODY,0,1,0,0.0,NULL,-99,NULL,NULL,1905},
	{0				   ,210,ENT_210  , -1,DB_BODY,0,0,0,0.0,NULL,-99,NULL,NULL,1906},
};

//Number of variables to search through
short ent_num_of_vars=sizeof(ent_DlgItems)/sizeof(ent_DlgItems[0]);

namespace acentprop
{
struct box_t
{
	point m_low, m_high;
	const box_t& operator += (const box_t& b);
};
const box_t& box_t::operator += (const box_t& b)
{
	int i;
	for (i = 0; i < 3; i++)
		if (m_low[i] > b.m_low[i])
			m_low[i] = b.m_low[i];
	for (i = 0; i < 3; i++)
		if (m_high[i] < b.m_high[i])
			m_high[i] = b.m_high[i];
	return *this;
}

enum
{
	e3dSolid,
	eRegion,
	eBody,
	nAcisEnts
};

static inline
bool convertDbTypeToAcisType(int dbtype, int* actype)
{
	if (dbtype == DB_3DSOLID)
		*actype = e3dSolid;
	else if (dbtype == DB_REGION)
		*actype = eRegion;
	else if (dbtype == DB_BODY)
		*actype = eBody;
	else
		return *actype = -1, false;
	return true;
}

static inline
int convertAcisTypeToDbType(int actype)
{
	if (actype == e3dSolid)
		return DB_3DSOLID;
	else if (actype == eRegion)
		return DB_REGION;
	else if (actype == eBody)
		return DB_BODY;
	assert(false);
	return -1;
}
}

void acisEnt_Data2Struct(sds_name ss)
{
	using namespace acentprop;

	CModeler* modeler = CModeler::get();
	if (!modeler->canView())
		return;

	box_t common[nAcisEnts];
	bool bbinit[nAcisEnts] = {false,false,false};
	{
		long n;
		sds_sslength(SDS_EditPropsSS,&n);
		sds_name ename;

		for (long i = 0l; RTNORM == sds_ssname(ss, i, ename); i++)
		{
			db_handitem* item = reinterpret_cast<db_handitem*>(ename[0]);
			int dbtype = item->ret_type();
			int actype;
			if (!convertDbTypeToAcisType(dbtype, &actype))
				continue;

			CDbAcisEntity* pObj = static_cast<CDbAcisEntity*>(item);

			box_t one;
			modeler->getBoundingBox(pObj->getData(), one.m_low, one.m_high, wcs2ucs());
			if (!bbinit[actype])
				common[actype] = one, bbinit[actype] = true;
			else
				common[actype] += one;
		}
	}
	{
		for (int ient = e3dSolid; ient < nAcisEnts; ient++)
		{
			if (!bbinit[ient])
				continue;

			int dbtype = convertAcisTypeToDbType(ient);

			int start = 0;
			while (ent_DlgItems[start++].EntTyp != dbtype);//Find the start of the section
			int end = start;
			while (ent_DlgItems[++end].EntTyp == dbtype);//Find the end of the section

			for(int i = start; i < end; i++)
			{
				ent_DlgItem& item = ent_DlgItems[i];
				sds_real value;
				switch (item.ID)
				{
				case ACIS_BOUNDBOXMINX:
					value = common[ient].m_low.x();
					break;
				case ACIS_BOUNDBOXMINY:
					value = common[ient].m_low.y();
					break;
				case ACIS_BOUNDBOXMINZ:
					value = common[ient].m_low.z();
					break;
				case ACIS_BOUNDBOXMAXX:
					value = common[ient].m_high.x();
					break;
				case ACIS_BOUNDBOXMAXY:
					value = common[ient].m_high.y();
					break;
				case ACIS_BOUNDBOXMAXZ:
					value = common[ient].m_high.z();
					break;
				default:
					continue;
				}

				item.OrgValue = value;
				item.DspValue = new char [50];
				sds_rtos(value, -1, -1, item.DspValue);
			}
		}
	}
}

static
bool selectionSetHasAcisEntities
(
sds_name ss
)
{
	sds_name ename;
	for (long i = 0l; RTNORM == sds_ssname(ss, i, ename); i++)
	{
		db_handitem* item = reinterpret_cast<db_handitem*>(ename[0]);
		int type = item->ret_type();
		if ((type != DB_3DSOLID) &&
			(type != DB_REGION) &&
			(type != DB_BODY))
			continue;

		return true;
	}
	return false;
}

//Added Cybage SBD	04/03/2002 DD/MM/YYYY [
//Reason : Fix for Bug No. 77983 from Bugzilla
//Checks if the DXF is a scale, returns true for same
// EBATECH(CNBR) 2002-Apr-24 Add SHAPE and DXF=40 for TEXT like object.
static bool isScaleType(int EntTyp,int resType)
{
	if(resType==48) //LTScale
		return true;
	else if( EntTyp==DB_INSERT && ( resType==41 || resType==42 ||resType==43 ) )
		return true;
	//else if( (EntTyp==DB_ATTDEF || EntTyp==DB_ATTRIB || EntTyp==DB_TEXT ) && resType==41 )
	else if( (EntTyp==DB_SHAPE || EntTyp==DB_ATTDEF || EntTyp==DB_ATTRIB || EntTyp==DB_TEXT ) &&
		( resType==40 || resType==41 ))
		return true;
	else
		return false;
}
//Added Cybage SBD	04/03/2002 DD/MM/YYYY ]

//This will fill the struct with the entity data
struct cmd_elistll *ent_Data2Struct(sds_name ss)
{
	struct cmd_elistll *pBeg=NULL,*pCur=NULL;
	if (selectionSetHasAcisEntities(ss) && CModeler::get()->canView())
		acisEnt_Data2Struct(ss);

    int start,end,index,EntType;
    CString csTmp;
    struct resbuf *pTmpRb=NULL,rbent,rbucs,*pRb=NULL;
    char fs1[IC_ACADBUF];
    sds_point ptUcs;

	rbucs.restype=RTSHORT;
	rbucs.resval.rint=1;


    num_of_splines=0;
    num_of_plines=false;  pVert=NULL;
    num_of_leaders=0;
	pDimItem = NULL;	/*D.G.*/

    cmd_ss2elistll(&pBeg,&pCur,ss,210); //convert a ss to a linked list.  NOTE:  we have to set th
	//->grpptr here because we need it BEFORE walking the llist so we can transform pts as we go
    for(pCur=pBeg;pCur!=NULL;pCur=pCur->next) {  //Loop through the selection set link list
        for(pTmpRb=pCur->entlst; pTmpRb!=NULL ; pTmpRb=pTmpRb->rbnext) {  //Loop through the first two links of the entity
            if(pTmpRb->restype<0) continue;
            if(pTmpRb->restype>=999) continue;
            if(pTmpRb->restype==0) {
                //Set the type of ent
                if(strsame(pTmpRb->resval.rstring,"3DFACE"/*DNT*/)) {
                    EntType=DB_3DFACE;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"ARC"/*DNT*/)) {
                    EntType=DB_ARC;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"ATTDEF"/*DNT*/)) {
                    EntType=DB_ATTDEF;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"ATTRIB"/*DNT*/)) {
                    EntType=DB_ATTRIB;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"CIRCLE"/*DNT*/)) {
                    EntType=DB_CIRCLE;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"DIMENSION"/*DNT*/)) {
                    EntType=DB_DIMENSION;
                    pTmpRb=pTmpRb->rbnext;
					pDimItem = pCur;	/*D.G.*/
                }
                else if(strsame(pTmpRb->resval.rstring,"ELLIPSE"/*DNT*/)) {
                    EntType=DB_ELLIPSE;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"INSERT")) {
                    EntType=DB_INSERT;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"LEADER"/*DNT*/)) {
                    EntType=DB_LEADER;
                    pTmpRb=pTmpRb->rbnext;
					// Bugzilla No. 78001; 18/03/2002
					pDimItem = pCur;
                    num_of_leaders++;
                }
                else if(strsame(pTmpRb->resval.rstring,"LINE"/*DNT*/)) {
                    EntType=DB_LINE;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"MLINE"/*DNT*/)) {
                    EntType=DB_MLINE;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"MTEXT"/*DNT*/)) {
                    EntType=DB_MTEXT;

                    csTmp.Empty();
                    for(pRb=pTmpRb;pRb!=NULL;pRb=pRb->rbnext){
                        if(pRb->restype==3){
                            if(pRb->resval.rstring){
                                csTmp+=pRb->resval.rstring;
                                IC_FREE(pRb->resval.rstring);
                                pRb->resval.rstring=NULL;
                            }
                        }
                    }
                    if(!csTmp.IsEmpty()){
                        for(pRb=pTmpRb;(pRb!=NULL&&pRb->restype!=1);pRb=pRb->rbnext);
                        if(pRb!=NULL) {
                            csTmp+=pRb->resval.rstring;
                            pRb->resval.rstring=ic_realloc_char((char *)pRb->resval.rstring,csTmp.GetLength()+1);
                            strcpy(pRb->resval.rstring,csTmp);
                        }
                    }
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"POLYLINE"/*DNT*/)) {
                    EntType=DB_POLYLINE;
                    pTmpRb=pTmpRb->rbnext;
                    //check for mesh
                    for(pRb=pTmpRb;(pRb!=NULL&&pRb->restype!=70);pRb=pRb->rbnext);
                    if(pRb->resval.rint & (IC_PLINE_POLYFACEMESH | IC_PLINE_3DMESH)) bPlineIsMesh=true;
                    if(pRb->resval.rint & (IC_PLINE_POLYFACEMESH | IC_PLINE_3DMESH | IC_PLINE_3DPLINE)) bPlineIs3D=true;

                    if(num_of_plines==false) {
                        num_of_plines=true;
                        pVert=pCur->next;		// first vertex entity
                    }else{
                        pVert=NULL;
                    }
					if(num_of_plines==true){
						if(NULL!=pCur->grpptr)
							entprop_plextru=&pCur->grpptr->resval.rpoint[0];
						else
							entprop_plextru=NULL;
					}
                }
                else if(strsame(pTmpRb->resval.rstring,"LWPOLYLINE"/*DNT*/)) {
					EntType=DB_LWPOLYLINE;
                    pTmpRb=pTmpRb->rbnext;

                    if(num_of_plines==false) {
                        num_of_plines=true;
                        pVert=pCur;				// LWPOLY entity
                    }else{
                        pVert=NULL;
                    }
					if(num_of_plines==true){
						if(NULL!=pCur->grpptr)
							entprop_plextru=&pCur->grpptr->resval.rpoint[0];
						else
							entprop_plextru=NULL;
					}
				}
                else if(strsame(pTmpRb->resval.rstring,"VERTEX"/*DNT*/)) {
                    EntType=DB_VERTEX;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"POINT"/*DNT*/)) {
                    EntType=DB_POINT;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"RAY"/*DNT*/)) {
                    EntType=DB_RAY;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"SEQEND"/*DNT*/)) {
                    EntType=DB_SEQEND;
                    pTmpRb=pTmpRb->rbnext;
                }
                // EBATECH(CNBR) -[ 2002/4/24 Add SHAPE
                else if(strsame(pTmpRb->resval.rstring,"SHAPE"/*DNT*/)) {
                    EntType=DB_SHAPE;
                    pTmpRb=pTmpRb->rbnext;
                }// EBATECH(CNBR) ]-
                else if(strsame(pTmpRb->resval.rstring,"SOLID"/*DNT*/)) {
                    EntType=DB_SOLID;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"SPLINE"/*DNT*/)) {
                    EntType=DB_SPLINE;
                    pTmpRb=pTmpRb->rbnext;
                    num_of_splines++;
                }
                else if(strsame(pTmpRb->resval.rstring,"TEXT"/*DNT*/)) {
                    EntType=DB_TEXT;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"TOLERANCE"/*DNT*/)) {
                    EntType=DB_TOLERANCE;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"TRACE"/*DNT*/)) {
                    EntType=DB_TRACE;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"VIEWPORT"/*DNT*/)) {
                    EntType=DB_VIEWPORT;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"XLINE"/*DNT*/)) {
                    EntType=DB_XLINE;
                    pTmpRb=pTmpRb->rbnext;
                }
                else if(strsame(pTmpRb->resval.rstring,"HATCH"/*DNT*/)) {
                    EntType=DB_HATCH;
                    pTmpRb=pTmpRb->rbnext;
                }
                //Modified Cybage MM 24-09-2001 DD-MM-YYYY [
				//Reason : Bug No.- 77847 from Bugzilla
				else if(strsame(pTmpRb->resval.rstring,"IMAGE"/*DNT*/)) {
                    EntType=DB_IMAGE;
                    pTmpRb=pTmpRb->rbnext;
                }
				else if (strsame(pTmpRb->resval.rstring,"3DSOLID"))
				{
					EntType = DB_3DSOLID;
					pTmpRb = pTmpRb->rbnext;
				}
				else if (strsame(pTmpRb->resval.rstring,"REGION"))
				{
					EntType = DB_REGION;
					pTmpRb = pTmpRb->rbnext;
				}
				else if (strsame(pTmpRb->resval.rstring,"BODY"))
				{
					EntType = DB_BODY;
					pTmpRb = pTmpRb->rbnext;
				}
                else break; //get the next entity and ignore this one

                //Go to the proper index of the struct
                for(start=0;(ent_DlgItems[start].EntTyp!=EntType);start++); //Find the start of the section
                for(end=start;(ent_DlgItems[end+1].EntTyp==EntType);end++); //Find the end of the section
            }
            for(index=start;index<=end;index++) {  //Loop through the proper section only
                if(pTmpRb->restype==ent_DlgItems[index].DXFCode) { //If the DXF codes match
                    if(ent_DlgItems[index].pRbll==NULL) {
                        ent_DlgItems[index].pCurll=ent_DlgItems[index].pRbll=new (struct ent_EntCodes);  //Make 1 new resbuf link
                    }else{
                        ent_DlgItems[index].pCurll=ent_DlgItems[index].pCurll->next=new (struct ent_EntCodes);  //Add 1 new resbuf link
                    }
                    ent_DlgItems[index].pCurll->prbb=pTmpRb; //Point the entity link to this new link
                    ent_DlgItems[index].pCurll->next=NULL; //Set next to NULL
                    switch(ent_DlgItems[index].ResType) {  //Match the type of value
						//Bugzilla No. 7219 ; 07-10-2002 [
						case DIME_TYPE:
							if(!ent_DlgItems[index].DoOnce){
                                ent_DlgItems[index].CheckBit=pTmpRb->resval.rint; //Store org value
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            break;
						case DIM_MEASURE:
							if(!ent_DlgItems[index].DoOnce){
                                ent_DlgItems[index].OrgValue=pTmpRb->resval.rreal; //Store org value
								int dimtype = ent_DlgItems[index - 1].CheckBit; //Get the type of dimension
								dimtype &= ~DIM_TEXT_MOVED;
								dimtype &= ~DIM_BIT_6;
								if(dimtype == DIM_ANGULAR || dimtype == DIM_ANGULAR_3P)
									sds_angtos_end(pTmpRb->resval.rreal,-1,-1,fs1);									
								else
									sds_rtos(pTmpRb->resval.rreal,-1,-1,fs1); //Convert real to string
								ent_DlgItems[index].DspValue=new char [strlen(fs1)+1]; //alloc memory
                                strcpy(ent_DlgItems[index].DspValue,fs1); //copy to struct
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            else if(!icadRealEqual(pTmpRb->resval.rreal,ent_DlgItems[index].OrgValue)){ //if a different value
                                if(!strisame(ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ),ent_DlgItems[index].DspValue)) {  //and varies is not there
                                    strcpy(fs1,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ));
                                    ent_DlgItems[index].DspValue=ic_realloc_char(ent_DlgItems[index].DspValue,strlen(fs1)+1); //alloc memory
                                    strcpy(ent_DlgItems[index].DspValue,fs1);
                                }
                            }
                            break;
						//Bugzilla No. 7219 ; 07-10-2002 ]
                        case RTREAL: //If it is a real in an edit box
                            if(!ent_DlgItems[index].DoOnce){
                                ent_DlgItems[index].OrgValue=pTmpRb->resval.rreal; //Store org value
								// DP: I had change request to display linetype scale independent on drawing units.
								// DP: So, now we always form linetype scale with decimal units.
								//Added Cybage SBD  04/03/2002 DD/MM/YYYY
								//Reason : Fix for Bug No. 77983 from Bugzilla
								//if(pTmpRb->restype == 48)
								if(isScaleType(EntType,pTmpRb->restype))
									sds_rtos(pTmpRb->resval.rreal,2,-1,fs1); //Convert linetype scale real to string using decimal units
								else
									sds_rtos(pTmpRb->resval.rreal,-1,-1,fs1); //Convert real to string
								ent_DlgItems[index].DspValue= new char [strlen(fs1)+1]; //alloc memory
                                strcpy(ent_DlgItems[index].DspValue,fs1); //copy to struct
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            else if(!icadRealEqual(pTmpRb->resval.rreal,ent_DlgItems[index].OrgValue)){ //if a different value
                                if(!strisame(ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ),ent_DlgItems[index].DspValue)) {  //and varies is not there
                                    strcpy(fs1,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ));
                                    ent_DlgItems[index].DspValue=ic_realloc_char(ent_DlgItems[index].DspValue,strlen(fs1)+1); //alloc memory
                                    strcpy(ent_DlgItems[index].DspValue,fs1);
                                }
                            }
                            break;
                        case RTANG: //If it is a angle in an edit box
                            if(!ent_DlgItems[index].DoOnce){
                                ent_DlgItems[index].OrgValue=pTmpRb->resval.rreal; //Store org value
                                sds_angtos(pTmpRb->resval.rreal,-1,-1,fs1); //Convert real to string
								ent_DlgItems[index].DspValue= new char [strlen(fs1)+1]; //alloc memory
                                strcpy(ent_DlgItems[index].DspValue,fs1); //copy to struct
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            else if(!icadRealEqual(pTmpRb->resval.rreal,ent_DlgItems[index].OrgValue)){ //if a different value
                                if(!strisame(ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ),ent_DlgItems[index].DspValue)) {  //and varies is not there
                                    strcpy(fs1,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ));
                                    ent_DlgItems[index].DspValue=ic_realloc_char(ent_DlgItems[index].DspValue,strlen(fs1)+1); //alloc memory
                                    strcpy(ent_DlgItems[index].DspValue,fs1);
                                }
                            }
                            break;
                        case RTANG_END: //If it is a angle in an edit box
                            if(!ent_DlgItems[index].DoOnce){
                                ent_DlgItems[index].OrgValue=pTmpRb->resval.rreal; //Store org value
                                sds_angtos_end(pTmpRb->resval.rreal,-1,-1,fs1); //Convert real to string
								ent_DlgItems[index].DspValue= new char [ strlen(fs1)+1]; //alloc memory
                                strcpy(ent_DlgItems[index].DspValue,fs1); //copy to struct
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            else if(!icadRealEqual(pTmpRb->resval.rreal,ent_DlgItems[index].OrgValue)){ //if a different value
                                if(!strisame(ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ),ent_DlgItems[index].DspValue)) {  //and varies is not there
                                    strcpy(fs1,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ));
                                    ent_DlgItems[index].DspValue=ic_realloc_char(ent_DlgItems[index].DspValue,strlen(fs1)+1); //alloc memory
                                    strcpy(ent_DlgItems[index].DspValue,fs1);
                                }
                            }
                            break;
                        case RTSHORT: //If it is a short in an edit box
                            if(!ent_DlgItems[index].DoOnce){
                                ent_DlgItems[index].CheckBit=pTmpRb->resval.rint; //Store org value
                                itoa(pTmpRb->resval.rint,fs1,10); //Convert int to string
								ent_DlgItems[index].DspValue= new char [strlen(fs1)+1]; //alloc memory
                                strcpy(ent_DlgItems[index].DspValue,fs1); //copy to struct
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            else if(ent_DlgItems[index].CheckBit!=pTmpRb->resval.rint){ //if a different value
                                if(!strisame(ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ),ent_DlgItems[index].DspValue)) {  //and varies is not there
                                    strcpy(fs1,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ));
                                    ent_DlgItems[index].DspValue=ic_realloc_char(ent_DlgItems[index].DspValue,strlen(fs1)+1); //alloc memory
                                    strcpy(ent_DlgItems[index].DspValue,fs1);
                                }
                            }
                            break;
                        case RT3DPOINT: //If it is a point in an edit box
                            if(!ent_DlgItems[index].DoOnce){
                                //ent_DlgItems[index].OrgValue=pTmpRb->resval.rpoint[ent_DlgItems[index].PtXYZ]; //Store org value
								if(ent_DlgItems[index].EntTyp!=DB_LEADER||
                                   ent_DlgItems[index].EntTyp!=DB_SPLINE||
                                   ent_DlgItems[index].EntTyp!=DB_VIEWPORT){
                                    if(ent_DlgItems[index].PtXYZ==0){
									    if(pCur->grpptr!=NULL){
										    rbent.restype=RT3DPOINT;
										    ic_ptcpy(rbent.resval.rpoint,pCur->grpptr->resval.rpoint);
									    }else{
										    rbent.restype=RTSHORT;
										    rbent.resval.rint=0;
									    }
									    sds_trans(pTmpRb->resval.rpoint,&rbent,&rbucs,0,ptUcs);
								    }
								    ent_DlgItems[index].OrgValue=ptUcs[ent_DlgItems[index].PtXYZ];
                                    sds_rtos(ptUcs[ent_DlgItems[index].PtXYZ],-1,-1,fs1); //Convert real to string
                                }else{
								    ent_DlgItems[index].OrgValue=pTmpRb->resval.rpoint[ent_DlgItems[index].PtXYZ];
                                    sds_rtos(pTmpRb->resval.rpoint[ent_DlgItems[index].PtXYZ],-1,-1,fs1); //Convert real to string
                                }                                
								ent_DlgItems[index].DspValue= new char [strlen(fs1)+1]; //alloc memory
                                strcpy(ent_DlgItems[index].DspValue,fs1); //copy to struct
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            else if(!icadRealEqual(pTmpRb->resval.rpoint[ent_DlgItems[index].PtXYZ],ent_DlgItems[index].OrgValue)){ //if a different value
                                if(!strisame(ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ),ent_DlgItems[index].DspValue)) {  //and varies is not there
                                    strcpy(fs1,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ));
                                    ent_DlgItems[index].DspValue=ic_realloc_char(ent_DlgItems[index].DspValue,strlen(fs1)+1); //alloc memory
                                    strcpy(ent_DlgItems[index].DspValue,fs1);
                                }
                            }
                            break;
                        case RTSTR: //If it is a string in an edit box
                            if(!ent_DlgItems[index].DoOnce){
//                                strncpy(fs1,pTmpRb->resval.rstring,sizeof(fs1)-1);    //took out for mtext
								ent_DlgItems[index].DspValue= new char [strlen(pTmpRb->resval.rstring)+1]; //alloc memory
                                strcpy(ent_DlgItems[index].DspValue,pTmpRb->resval.rstring); //copy to struct
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            // EBATECH(CNBR) -[ Some Fields should not ignore case
                            else if( ent_DlgItems[index].DXFCode == 1 ||
                            	( ent_DlgItems[index].DXFCode == 3 && ent_DlgItems[index].EntTyp == DB_ATTDEF )){
                            	if(!strsame(pTmpRb->resval.rstring,ent_DlgItems[index].DspValue)){ //if a different value
                                	if(!strsame(ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ),ent_DlgItems[index].DspValue)) {  //and varies is not there
                                    	strcpy(fs1,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ));
                                    	ent_DlgItems[index].DspValue=ic_realloc_char(ent_DlgItems[index].DspValue,strlen(fs1)+1); //alloc memory
                                    	strcpy(ent_DlgItems[index].DspValue,fs1);
                                	}
                                }
							}
                            // EBATECH(CNBR) ]-
                            else if(!strisame(pTmpRb->resval.rstring,ent_DlgItems[index].DspValue)){ //if a different value
                                if(!strisame(ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ),ent_DlgItems[index].DspValue)) {  //and varies is not there
                                    strcpy(fs1,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ));
                                    ent_DlgItems[index].DspValue=ic_realloc_char(ent_DlgItems[index].DspValue,strlen(fs1)+1); //alloc memory
                                    strcpy(ent_DlgItems[index].DspValue,fs1);
                                }
                            }
                            break;
                        case ENT_CHECK: //If it is a short in a check box
                            if(!ent_DlgItems[index].DoOnce){
                                if(pTmpRb->resval.rint&ent_DlgItems[index].PtXYZ) {
                                    ent_DlgItems[index].CheckBit=1;  //Store the value
                                }else{
                                    ent_DlgItems[index].CheckBit=0;  //Store the value
                                }
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            else{
                                if(pTmpRb->resval.rint&ent_DlgItems[index].PtXYZ) {
                                    if(ent_DlgItems[index].CheckBit!=1) ent_DlgItems[index].CheckBit=2; //Gray out the check box
                                }else{
                                    if(ent_DlgItems[index].CheckBit!=0) ent_DlgItems[index].CheckBit=2; //Gray out the check box
                                }
                            }
                            break;
                        case ENT_GREY: //If it is a grey out
                            if(!ent_DlgItems[index].DoOnce){
                                ent_DlgItems[index].CheckBit=(pTmpRb->resval.rint&ent_DlgItems[index].PtXYZ); //Store the value
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            else if((pTmpRb->resval.rint&ent_DlgItems[index].PtXYZ)!=ent_DlgItems[index].CheckBit){ //if a different value
                                ent_DlgItems[index].CheckBit=0;  //Gray out the check box
                            }
                            break;
                        case ENT_JUSTI: //If it is a short index for a combo box  used in attr,attd,text for justification
                                ent_DlgItems[index].CheckBit|=(1<<pTmpRb->resval.rint); //Store the value
                            break;
                        case ENT_COMBO:
							// Bugzilla No. 76186; 11/11/2002 [
                            if(!ent_DlgItems[index].DoOnce){
                                ent_DlgItems[index].CheckBit=pTmpRb->resval.rint - 1; //Store the value
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            else if(ent_DlgItems[index].CheckBit!=( pTmpRb->resval.rint - 1 )){ //if a different value
                                if ( MTEXT_DIRECTION == ent_DlgItems[index].ID )
									ent_DlgItems[index].CheckBit=5;								
								else if ( MTEXT_JUSTIFY   == ent_DlgItems[index].ID )
									ent_DlgItems[index].CheckBit=9;
                            }
							// Bugzilla No. 76186; 11/11/2002 ]
                            break;
                        case ENT_COL: //If it is a COLOR
                            if(!ent_DlgItems[index].DoOnce){
                                ent_DlgItems[index].SColor=pTmpRb->resval.rint; //Store the value
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            else if(pTmpRb->resval.rint!=ent_DlgItems[index].SColor){ //if a different value
                                ent_DlgItems[index].SColor=-1;  //Varies
                            }
                            break;
							// EBATECH(CNBR) -[ 31-03-2003 Bugzilla#78471 , CONST 3 means DEFAULT(-3) to 1st Item(0)
                        case ENT_LW:
                            if(!ent_DlgItems[index].DoOnce){
                                ent_DlgItems[index].SColor=db_lweight2index(pTmpRb->resval.rint)+3;
                                ent_DlgItems[index].DoOnce=1; //only do this once
                            }
                            else if(ent_DlgItems[index].SColor != 27 && pTmpRb->resval.rint!=db_index2lweight(ent_DlgItems[index].SColor-3)){
                                ent_DlgItems[index].SColor = 27;  //Varies
                            }
                            break;
							// EBATECH(CNBR) ]-
                    }
                }
            }
        }
    }
    return(pBeg);
}


void ent_Struct2ll() {
    struct ent_EntCodes *pCur,*p210;
    char fs1[MAX_REAL_LEN];
    int i,j;
	long k,l;
	sds_point pTmp,pTmp2;
	int curdim;
	struct resbuf rbent,rbucs;

	rbucs.restype=RTSHORT;
	rbucs.resval.rint=1;

    for(i=0;i<ent_num_of_vars;i++) {
        for(pCur=ent_DlgItems[i].pRbll,k=0L;pCur!=NULL;pCur=pCur->next,k++) {
            if(ent_DlgItems[i].ReadOnly) {
                break;
            }else if((ent_DlgItems[i].DspValue!=NULL)&&(strisame(ent_DlgItems[i].DspValue,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" )))) {
                break;
            }
            switch(ent_DlgItems[i].ResType) {
                case RTREAL: //If it is a real in an edit box
                    if(ent_DlgItems[i].DspValue==NULL) break;
                    sds_rtos(ent_DlgItems[i].OrgValue,-1,-1,fs1); //Convert real to string
                    if(!strisame(fs1,ent_DlgItems[i].DspValue))
                        sds_distof(ent_DlgItems[i].DspValue,-1,&pCur->prbb->resval.rreal);
                    break;
                case RTANG: //If it is a real in an edit box
                    if(ent_DlgItems[i].DspValue==NULL) break;
                    sds_angtos(ent_DlgItems[i].OrgValue,-1,-1,fs1); //Convert real to string
                    if(!strisame(fs1,ent_DlgItems[i].DspValue))
                        sds_angtof(ent_DlgItems[i].DspValue,-1,&pCur->prbb->resval.rreal);
                    break;
                case RTANG_END: //If it is a real in an edit box
                    if(ent_DlgItems[i].DspValue==NULL) break;
                    sds_angtos_end(ent_DlgItems[i].OrgValue,-1,-1,fs1); //Convert real to string
                    if(!strisame(fs1,ent_DlgItems[i].DspValue))
                        sds_angtof(ent_DlgItems[i].DspValue,-1,&pCur->prbb->resval.rreal);
                    break;
                case RTSHORT: //If it is a short in an edit box
                    if(ent_DlgItems[i].DspValue==NULL) break;
                    pCur->prbb->resval.rint=atoi(ent_DlgItems[i].DspValue);
                    break;
                case RT3DPOINT: //If it is a point in an edit box
                    //we'll take each ordinate [X,Y,Z], and get it's delta in ucs.  Then make a vector
                    //  out of it (other ordinates 0.0) and transform it into native coords for that entity.
                    //  Then add all 3 components of transformed vector to original value.  Repeat for each ordinate.
                    if(ent_DlgItems[i].DspValue==NULL) break;
                    sds_rtos(ent_DlgItems[i].OrgValue,-1,-1,fs1); //Convert real to string
                    if(!strisame(fs1,ent_DlgItems[i].DspValue)){ //was it changed in the dialog????
					    if(ent_DlgItems[i].EntTyp!=DB_LEADER&&
                           ent_DlgItems[i].EntTyp!=DB_SPLINE&&
                           ent_DlgItems[i].EntTyp!=DB_VIEWPORT){ //no ucs change necessary
                    	    //create "offset vector" for change in point's value
						    for(curdim=0;curdim<3;curdim++){
							    if(curdim==ent_DlgItems[i].PtXYZ){
                                    sds_distof(ent_DlgItems[i].DspValue,-1,&pTmp[curdim]);
                                    //pTmp[curdim]=-pTmp[curdim];
								    //pTmp[curdim]-=ent_DlgItems[i].OrgValue;
                                    //pCur->prbb->resval.rpoint[curdim]
							    }else{
								    pTmp[curdim]=0.0;
							    }
						    }
						    //get the appropriate 210 (or world) resbuf to transform vector to native coords
						    for(j=i;ent_DlgItems[j].DXFCode!=210;j++);
						    if(ent_DlgItems[j].PtXYZ<0){
							    //wcs
                                rbent.restype=RTSHORT;
							    rbent.resval.rint=0;
						    }else{
							    //ecs
                                for(l=0L;l<=k;l++){
								    if(l==0L) p210=ent_DlgItems[j].pRbll;
								    else p210=p210->next;
							    }
							    rbent.restype=RT3DPOINT;
							    ic_ptcpy(rbent.resval.rpoint,p210->prbb->resval.rpoint);
						    }
                            sds_trans(pCur->prbb->resval.rpoint,&rbent,&rbucs,0,pTmp2);
                            pTmp[ent_DlgItems[i].PtXYZ]=pTmp[ent_DlgItems[i].PtXYZ]-pTmp2[ent_DlgItems[i].PtXYZ];
						    sds_trans(pTmp,&rbucs,&rbent,1,pTmp);
                            //add displacement vector to original value in llist
						    pCur->prbb->resval.rpoint[0]+=pTmp[0];
						    pCur->prbb->resval.rpoint[1]+=pTmp[1];
						    pCur->prbb->resval.rpoint[2]+=pTmp[2];
						}else{
                            sds_distof(ent_DlgItems[i].DspValue,-1,&pCur->prbb->resval.rpoint[ent_DlgItems[i].PtXYZ]);
                        }
                    }
                    break;
                case RTSTR: //If it is a string in an edit box
           //         if(ent_DlgItems[i].DspValue==NULL) break;   //allow null strings to be entmod
                    if(ent_DlgItems[i].DspValue==NULL) {
                        pCur->prbb->resval.rstring=ic_realloc_char(pCur->prbb->resval.rstring,1); //alloc memory
                        pCur->prbb->resval.rstring='\0';
                    }else{
                        pCur->prbb->resval.rstring=ic_realloc_char(pCur->prbb->resval.rstring,strlen(ent_DlgItems[i].DspValue)+1); //alloc memory
                        strcpy(pCur->prbb->resval.rstring,ent_DlgItems[i].DspValue);
                    }
                    break;
                case ENT_CHECK: //If it is a short in a check box
                    if(ent_DlgItems[i].CheckBit==0) {
                        pCur->prbb->resval.rint=(pCur->prbb->resval.rint) & (~ent_DlgItems[i].PtXYZ);
                    }else if(ent_DlgItems[i].CheckBit==1) {
                        pCur->prbb->resval.rint=(pCur->prbb->resval.rint) | (ent_DlgItems[i].PtXYZ);
                    }
                    break;
                case ENT_JUSTI: //If it is a combo
                    if(ent_DlgItems[i].DXFCode==72){
                        switch(ent_DlgItems[i].CheckBit){
                            case 1:
                                pCur->prbb->resval.rint=0;
                                break;
                            case 2:
                                pCur->prbb->resval.rint=1;
                                break;
                            case 4:
                                pCur->prbb->resval.rint=2;
                                break;
                            case 8:
                                pCur->prbb->resval.rint=3;
                                break;
                            case 16:
                                pCur->prbb->resval.rint=4;
                                break;
                            case 32:
                                pCur->prbb->resval.rint=5;
                                break;
                        }
                    }else{    //for 73 and 74
                        switch(ent_DlgItems[i].CheckBit){
                            case 1:
                                pCur->prbb->resval.rint=0;
                                break;
                            case 2:
                                pCur->prbb->resval.rint=1;
                                break;
                            case 4:
                                pCur->prbb->resval.rint=2;
                                break;
                            case 8:
                                pCur->prbb->resval.rint=3;
                                break;
                        }
                    }
                    break;
                case ENT_COMBO:
					// Bugzilla No. 76186; 11/11/2002 [
                    if ( ( MTEXT_DIRECTION == ent_DlgItems[i].ID && ent_DlgItems[i].CheckBit != 5 )||
						 ( MTEXT_JUSTIFY   == ent_DlgItems[i].ID && ent_DlgItems[i].CheckBit != 9 )
						)
					{
                        pCur->prbb->resval.rint=ent_DlgItems[i].CheckBit + 1;
                    }
					// Bugzilla No. 76186; 11/11/2002 ]
                    break;
                case ENT_COL:
                    if(ent_DlgItems[i].SColor!=-1 && ent_DlgItems[i].SColor!=-99) {
                        pCur->prbb->resval.rint=ent_DlgItems[i].SColor;
                    }
                    break;
				// EBATECH(CNBR) -[ 31-03-2003 Bugzilla#78471 Support Lineweight
                case ENT_LW:
                    if( 0 <= ent_DlgItems[i].SColor && ent_DlgItems[i].SColor < 27 ) {
                        pCur->prbb->resval.rint=db_index2lweight(ent_DlgItems[i].SColor-3);
                    }
                    break;
				// EBATECH(CNBR) ]-
            }
        }
    }
}

//*****This function will control the spiners
void ent_SpinMasterInt(HWND hWndItem,int increment) {
    int iTmp;
    char szTmp[IC_ACADBUF];

    ::GetWindowText(hWndItem,szTmp,IC_ACADBUF-1);
    iTmp=atoi(szTmp);
    iTmp+=(-increment);
    if(iTmp<1) iTmp=1;
    itoa(iTmp,szTmp,10);
    ::SetWindowText(hWndItem,szTmp);
}

// DP: I had change request to display linetype scale independent on drawing units.
// DP: So, now we always form linetype scale with decimal units
// DP: and for correct spinning we need nUnitType parameter.
void ent_SpinMasterReal(HWND hWndItem,int increment,int nUnitType /* = -1 */) {
    double dTmp;
    char szTmp[IC_ACADBUF];

    ::GetWindowText(hWndItem,szTmp,IC_ACADBUF-1);
    sds_distof(szTmp,-1,&dTmp);
    dTmp+=(-increment)*1/((LUNITS==4||LUNITS==5)?(1<<LUPREC):pow(10,LUPREC));
    sds_rtos(dTmp,nUnitType,-1,szTmp);
    ::SetWindowText(hWndItem,szTmp);
}

void ent_SpinMasterAngle(HWND hWndItem,int increment) {
    double dTmp;
    char szTmp[IC_ACADBUF];

    ::GetWindowText(hWndItem,szTmp,IC_ACADBUF-1);
    sds_angtof(szTmp,-1,&dTmp);
    switch(AUNITS){
        case 0:
            dTmp+=(IC_PI/180)*(-increment)*(1/pow(10,AUPREC));
            break;
        case 1:
        case 4:
            switch(AUPREC){
                case 0:
                    dTmp+=(IC_PI/180)*(1.0/pow(10,AUPREC))*(-increment);
                    break;
                case 1:
                case 2:
                    dTmp+=(IC_PI/180)*(1.0/(6.0*pow(10,AUPREC-1)))*(-increment);
                    break;
                case 3:
                case 4:
                case 5:
                case 6:
                case 7:
                case 8:
                    dTmp+=(IC_PI/180)*(1.0/(360.0*pow(10,AUPREC-3)))*(-increment);
                    break;
            }
            break;
        case 2:
            dTmp+=(IC_PI/200)*(-increment)*(1/pow(10,AUPREC));
            break;
        case 3:
            dTmp+=(-increment)*(1/pow(10,AUPREC));
            break;
    }
    sds_angtos(dTmp,-1,-1,szTmp);
    ::SetWindowText(hWndItem,szTmp);
}

void ent_SpinMasterEndAngle(HWND hWndItem,int increment) {
    double dTmp;
    char szTmp[IC_ACADBUF];

    ::GetWindowText(hWndItem,szTmp,IC_ACADBUF-1);
    sds_angtof(szTmp,-1,&dTmp);
    switch(AUNITS){
        case 0:
            dTmp+=(IC_PI/180)*(-increment)*(1/pow(10,AUPREC));
            break;
        case 1:
        case 4:
            switch(AUPREC){
                case 0:
                    dTmp+=(IC_PI/180)*(1.0/pow(10,AUPREC))*(-increment);
                    break;
                case 1:
                case 2:
                    dTmp+=(IC_PI/180)*(1.0/(6.0*pow(10,AUPREC-1)))*(-increment);
                    break;
                case 3:
                case 4:
                case 5:
                case 6:
                case 7:
                case 8:
                    dTmp+=(IC_PI/180)*(1.0/(360.0*pow(10,AUPREC-3)))*(-increment);
                    break;
            }
            break;
        case 2:
            dTmp+=(IC_PI/200)*(-increment)*(1/pow(10,AUPREC));
            break;
        case 3:
            dTmp+=(-increment)*(1/pow(10,AUPREC));
            break;
    }
    sds_angtos_end(dTmp,-1,-1,szTmp);
    ::SetWindowText(hWndItem,szTmp);
}


// ==================================================================================
// This is the main window for the ddmodify dialog box
// ==================================================================================

class ent_EntityProperties : public IcadDialog {
    public:
        int         m_CurSel,
                    m_PrvSel,
                    m_GenColor;
        int         m_GenLweight;// EBATECH(CNBR) 31-03-2003 Bugzilla#78471 Support Lineweight
        long        m_TabsFlag,
                    m_TabIndex[ENT_NUM_OF_ENTITIES];
        char        m_GenLayer[IC_ACADBUF],
                    m_GenLinetype[IC_ACADBUF];
        CString     m_GenLTScale,
                    m_GenThick;
		// DP
		CDialogHyperlink m_editHL;
		CString		m_linkDesc;
        CTabCtrl    m_TabCtrl;

        ent_3DFACE_TAB    m_3DFACE_TAB;
        ent_ARC_TAB       m_ARC_TAB;
        ent_ATTDEF_TAB    m_ATTDEF_TAB;
        ent_ATTRIB_TAB    m_ATTRIB_TAB;
        ent_CIRCLE_TAB    m_CIRCLE_TAB;
        ent_DIM_TAB       m_DIM_TAB;
        ent_ELP_TAB       m_ELP_TAB;
        //Modified Cybage MM 24-09-2001 DD-MM-YYYY [
		//Reason : Bug No.- 77847 from Bugzilla
		ent_IMAGE_TAB     m_IMAGE_TAB;
		//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]
        ent_INSERT_TAB    m_INSERT_TAB;
        ent_LEADER_TAB    m_LEADER_TAB;
        ent_LINE_TAB      m_LINE_TAB;
        ent_MLINE_TAB     m_MLINE_TAB;
        ent_MTEXT_TAB     m_MTEXT_TAB;
        ent_PLINE_TAB     m_PLINE_TAB;
        ent_LWPLINE_TAB   m_LWPLINE_TAB;
        ent_POINT_TAB     m_POINT_TAB;
        ent_RAY_TAB       m_RAY_TAB;
        //EBATECH(CNBR) -[ 2002/4/24 SHAPE
		ent_SHAPE_TAB     m_SHAPE_TAB;
		//EBATECH(CNBR) ]-
        ent_SOLID_TAB     m_SOLID_TAB;
        ent_SPLINE_TAB    m_SPLINE_TAB;
        ent_TEXT_TAB      m_TEXT_TAB;
        ent_TOLER_TAB     m_TOLER_TAB;
        ent_TRACE_TAB     m_TRACE_TAB;
        ent_VIEWP_TAB     m_VIEWP_TAB;
        ent_XLINE_TAB     m_XLINE_TAB;
		ent_HATCH_TAB	  m_HATCH_TAB;
		ent_3DSOLID_TAB	  m_3DSOLID_TAB;
		ent_REGION_TAB	  m_REGION_TAB;
		ent_BODY_TAB	  m_BODY_TAB;

        ent_EntityProperties();
        BOOL OnInitDialog();
        void ent_GetLayer();
        void ent_GetLinetype();
        void ent_GetLTScale();
        void ent_GetThickness();
        void ent_GetColor();
        void ent_LayerLineChoice(BOOL mode);
        void ent_ColorPick();
        // EBATECH(CNBR) -[ 31-03-2003 Bugzilla#78471 Support Lineweight
        void ent_GetLweight();
        void ent_LweightChoice();
        // EBATECH(CNBR) ]-
    protected:
        //Modified Cybage MM 24-09-2001 DD-MM-YYYY [
		//Reason : Bug No.- 77847 from Bugzilla
		virtual void OnOK();
		//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]
        afx_msg void ReadLtLay();
        afx_msg void OnExp();
        afx_msg void OnHelp();
        afx_msg void OnSpinGenWidth(NMHDR *pNotifyStruct,LRESULT *result);
        afx_msg void OnSpinGenLtScale(NMHDR *pNotifyStruct,LRESULT *result);
   	    afx_msg void OnPaint();
    	afx_msg void OnTabChange( NMHDR * pNotifyStruct, LRESULT * result );
    	virtual void DoDataExchange(CDataExchange* pDX);
        afx_msg void OnDestroy();
        afx_msg BOOL OnHelpInfo(HELPINFO *pHel);
		// DP
		afx_msg void OnEditLink();

	DECLARE_MESSAGE_MAP()
private:
	void EnableControlsForHatch(BOOL enable);
    //Modified Cybage MM 24-09-2001 DD-MM-YYYY [
	//Reason : Bug No.- 77847 from Bugzilla
	void EnableControlsForImage(BOOL enable);
	//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]
};

BEGIN_MESSAGE_MAP(ent_EntityProperties, CDialog)
    ON_BN_CLICKED(IDHELP,OnHelp)
    ON_BN_CLICKED(EXP_EXPLORE,OnExp)
    ON_NOTIFY(UDN_DELTAPOS,UPDN_GENTHICK,OnSpinGenWidth)
    ON_NOTIFY(UDN_DELTAPOS,UPDN_GENSCALE,OnSpinGenLtScale)
    ON_NOTIFY(TCN_SELCHANGE, GEN_TAB, OnTabChange)
    ON_WM_DESTROY()
    ON_COMMAND(GEN_COLOR_PICK,ent_ColorPick)
    ON_WM_PAINT()
	ON_WM_HELPINFO()
    ON_COMMAND(ICAD_WNDACTION_EXP_RETURN,ReadLtLay)
    ON_COMMAND(GEN_HYPERLINK_PICK, OnEditLink)
END_MESSAGE_MAP()

//Modified Cybage MM 24-09-2001 DD-MM-YYYY [
//Reason : Bug No.- 77847 from Bugzilla
void ent_EntityProperties::OnOK()
{
	if(m_IMAGE_TAB.m_hWnd!=NULL){
		m_IMAGE_TAB.OnOK();
		if(m_IMAGE_TAB.validationFailure) return;
	}
	CDialog::OnOK();
}
//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]

BOOL ent_EntityProperties::OnHelpInfo(HELPINFO *pHel){
	OnHelp();
	return(true);
}
void ent_EntityProperties::OnHelp() {
	CommandRefHelp( m_hWnd, HLP_ENTPROP);
}

void ent_EntityProperties::OnExp() {
    SDS_CMainWindow->m_ExpReturnHwnd=m_hWnd;
    SDS_CMainWindow->IcadExplorer(0);
}

void ent_EntityProperties::ReadLtLay(){
    ent_LayerLineChoice(TRUE); //Layer
    ent_LayerLineChoice(FALSE); //Linetype
    UpdateData(false);
    if(m_TEXT_TAB){
        m_TEXT_TAB.ent_StyleChoice();
        m_TEXT_TAB.UpdateData(false);
    }
    if(m_ATTDEF_TAB){
        m_ATTDEF_TAB.ent_StyleChoice();
        m_ATTDEF_TAB.UpdateData(false);
    }
    if(m_ATTRIB_TAB){
        m_ATTRIB_TAB.ent_StyleChoice();
        m_ATTRIB_TAB.UpdateData(false);
    }
}

void ent_EntityProperties::OnSpinGenWidth(NMHDR *pNotifyStruct,LRESULT *result) {
    NM_UPDOWN* pNMUpDown = (NM_UPDOWN*)pNotifyStruct;
    ent_SpinMasterReal(::GetDlgItem(m_hWnd,GEN_THICKNESS),pNMUpDown->iDelta);
    UpdateData(TRUE);
    *result=0;
}

void ent_EntityProperties::OnSpinGenLtScale(NMHDR *pNotifyStruct,LRESULT *result) {
    NM_UPDOWN* pNMUpDown = (NM_UPDOWN*)pNotifyStruct;
	// DP: I had change request to display linetype scale independent on drawing units.
	// DP: So, now we always form linetype scale with decimal units.
    ent_SpinMasterReal(::GetDlgItem(m_hWnd,GEN_LTSCALE),pNMUpDown->iDelta,2);
    UpdateData(TRUE);
    *result=0;
}

void ent_EntityProperties::ent_ColorPick() {

    if(m_GenColor==-1) {
        SDS_GetColorDialog(258,&m_GenColor,2);
    }else{
        SDS_GetColorDialog(m_GenColor,&m_GenColor,2);
    }
    if(m_GenColor==258) m_GenColor=-1;

    ::SendMessage(m_hWnd,WM_PAINT,0,0);
}

void ent_EntityProperties::OnPaint() {
    CDialog::OnPaint();

    CBrush brush;
    RECT rect;
    HDC hDC,hCmpDC;
    HWND hItemWnd;
    HBITMAP hBitmap;

    if(m_GenColor>=1 && m_GenColor<=255) {
        hItemWnd=::GetDlgItem(m_hWnd,GEN_COLOR);
        hDC=::GetDC(hItemWnd);
		HPALETTE oldpal=::SelectPalette(hDC,(HPALETTE)SDS_CMainWindow->m_pPalette->GetSafeHandle(),TRUE);
        brush.CreateSolidBrush(SDS_BrushColorFromACADColor(m_GenColor));
        ::GetClientRect(hItemWnd,&rect);
        ::FillRect(hDC,&rect,(HBRUSH)brush);
        brush.DeleteObject();
//		::SelectPalette(hDC,oldpal,TRUE);
        ::ReleaseDC(hItemWnd,hDC);
    }else if(m_GenColor==0) {
        hItemWnd=::GetDlgItem(m_hWnd,GEN_COLOR);
        hBitmap=LoadBitmap(AfxGetApp()->m_hInstance,MAKEINTRESOURCE(EC_COLOR_BMP));
        hDC=::GetDC(hItemWnd);
        hCmpDC=CreateCompatibleDC(hDC);
        ::GetClientRect(hItemWnd,&rect);
        SelectObject(hCmpDC,hBitmap);
        BitBlt(hDC,rect.left,rect.top,rect.right,rect.bottom,hCmpDC,rect.left,rect.top,SRCCOPY);
        DeleteDC(hCmpDC);
        ::ReleaseDC(hItemWnd,hDC);
    }else if(m_GenColor==256) {
        hItemWnd=::GetDlgItem(m_hWnd,GEN_COLOR);
        hBitmap=LoadBitmap(AfxGetApp()->m_hInstance,MAKEINTRESOURCE(EC_COLOR_BMP256));
        hDC=::GetDC(hItemWnd);
        hCmpDC=CreateCompatibleDC(hDC);
        ::GetClientRect(hItemWnd,&rect);
        SelectObject(hCmpDC,hBitmap);
        BitBlt(hDC,rect.left,rect.top,rect.right,rect.bottom,hCmpDC,rect.left,rect.top,SRCCOPY);
        DeleteDC(hCmpDC);
        ::ReleaseDC(hItemWnd,hDC);
    }else if(m_GenColor==-1) {
        hItemWnd=::GetDlgItem(m_hWnd,GEN_COLOR);
        hBitmap=LoadBitmap(AfxGetApp()->m_hInstance,MAKEINTRESOURCE(COL_VARIES));
        hDC=::GetDC(hItemWnd);
        hCmpDC=CreateCompatibleDC(hDC);
        ::GetClientRect(hItemWnd,&rect);
        SelectObject(hCmpDC,hBitmap);
        BitBlt(hDC,rect.left,rect.top,rect.right,rect.bottom,hCmpDC,rect.left,rect.top,SRCCOPY);
        DeleteDC(hCmpDC);
        ::ReleaseDC(hItemWnd,hDC);
    }
}

void ent_EntityProperties::OnDestroy(){
	extern HWND SDS_hWndExplorerCaller;
	SDS_hWndExplorerCaller = NULL;

    m_TabsFlag=0;
    for(int i=0;i<ENT_NUM_OF_ENTITIES;i++) m_TabIndex[i]=0;

    CDialog::OnDestroy();

    if(m_3DFACE_TAB) {m_3DFACE_TAB.UpdateData(TRUE);}
    if(m_ARC_TAB)    {m_ARC_TAB.UpdateData(TRUE);   }
    if(m_ATTDEF_TAB) {m_ATTDEF_TAB.UpdateData(TRUE);}
    if(m_ATTRIB_TAB) {m_ATTRIB_TAB.UpdateData(TRUE);}
    if(m_CIRCLE_TAB) {m_CIRCLE_TAB.UpdateData(TRUE);}
    if(m_DIM_TAB)    {m_DIM_TAB.UpdateData(TRUE);   }
    if(m_ELP_TAB)    {m_ELP_TAB.UpdateData(TRUE);   }
    //Modified Cybage MM 24-09-2001 DD-MM-YYYY [
	//Reason : Bug No.- 77847 from Bugzilla
	if(m_IMAGE_TAB)  {m_IMAGE_TAB.UpdateData(TRUE); }
	//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]
    if(m_INSERT_TAB) {m_INSERT_TAB.UpdateData(TRUE);}
    if(m_LEADER_TAB) {m_LEADER_TAB.UpdateData(TRUE);}
    if(m_LINE_TAB)   {m_LINE_TAB.UpdateData(TRUE);  }
    if(m_MLINE_TAB)  {m_MLINE_TAB.UpdateData(TRUE); }
    if(m_MTEXT_TAB)  {m_MTEXT_TAB.UpdateData(TRUE); }
    if(m_PLINE_TAB)  {m_PLINE_TAB.UpdateData(TRUE);m_PLINE_TAB.GrabVert();m_PLINE_TAB.GrabElev();}
						// order of calls intentionally changed, since LWPOLYLINE
						// not implemented with VERTEX entities
    if(m_LWPLINE_TAB)
		{
		m_LWPLINE_TAB.GetVertex();
		m_LWPLINE_TAB.GrabElev();
		m_LWPLINE_TAB.UpdateData(TRUE);
		}

    if(m_POINT_TAB)  {m_POINT_TAB.UpdateData(TRUE); }
    if(m_RAY_TAB)    {m_RAY_TAB.UpdateData(TRUE);   }
    //EBATECH(CNBR) -[ 2002/4/24
	if(m_SHAPE_TAB)  {m_SHAPE_TAB.UpdateData(TRUE); }
	//EBATECH(CNBR) ]-
    if(m_SOLID_TAB)  {m_SOLID_TAB.UpdateData(TRUE); }
    if(m_SPLINE_TAB) {m_SPLINE_TAB.UpdateData(TRUE);}
    if(m_TEXT_TAB)   {m_TEXT_TAB.UpdateData(TRUE);  }
    if(m_TOLER_TAB)  {m_TOLER_TAB.UpdateData(TRUE); }
    if(m_TRACE_TAB)  {m_TRACE_TAB.UpdateData(TRUE); }
    if(m_VIEWP_TAB)  {m_VIEWP_TAB.UpdateData(TRUE); }
    if(m_XLINE_TAB)  {m_XLINE_TAB.UpdateData(TRUE); }
	if(m_HATCH_TAB)	 {m_HATCH_TAB.UpdateData(TRUE); }
	if(m_3DSOLID_TAB){m_3DSOLID_TAB.UpdateData(TRUE);}
	if(m_REGION_TAB) {m_REGION_TAB.UpdateData(TRUE); }
	if(m_BODY_TAB)	 {m_BODY_TAB.UpdateData(TRUE);   }
}

void ent_EntityProperties::DoDataExchange(CDataExchange *pDX) {
    int index,i;

	DDX_Control(pDX, GEN_TAB, m_TabCtrl);
    DDX_Text(pDX,GEN_LTSCALE,m_GenLTScale);
    DDX_Text(pDX,GEN_THICKNESS,m_GenThick);
    if(!pDX->m_bSaveAndValidate) { //To dialog
        index=::SendMessage(::GetDlgItem(m_hWnd,GEN_LAYER),CB_FINDSTRINGEXACT,(WPARAM)-1,(LPARAM)m_GenLayer);
        DDX_CBIndex(pDX,GEN_LAYER,index);
        index=::SendMessage(::GetDlgItem(m_hWnd,GEN_LINETYPE),CB_FINDSTRINGEXACT,(WPARAM)-1,(LPARAM)m_GenLinetype);
        DDX_CBIndex(pDX,GEN_LINETYPE,index);
		// EBATECH(CNBR) -[ 31-03-2003 Bugzilla#78471 Support Lineweight
        DDX_CBIndex(pDX,GEN_LW, m_GenLweight);
		// EBATECH(CNBR) ]-
    }else{ //From dialog
        DDX_CBIndex(pDX,GEN_LAYER,index);
        ::SendMessage(::GetDlgItem(m_hWnd,GEN_LAYER),CB_GETLBTEXT,(WPARAM)index,(LPARAM)m_GenLayer);
        DDX_CBIndex(pDX,GEN_LINETYPE,index);
        ::SendMessage(::GetDlgItem(m_hWnd,GEN_LINETYPE),CB_GETLBTEXT,(WPARAM)index,(LPARAM)m_GenLinetype);
        DDX_CBIndex(pDX,GEN_LW, m_GenLweight );
        //This section will put the data back into ent_DlgItems[i].DspValue.
        for(i=0;i<ent_num_of_vars;i++) {
            switch(ent_DlgItems[i].ID) {
                case GEN_LAYER:
                    if(ent_DlgItems[i].DspValue!=NULL && !strisame(m_GenLayer,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ))) {
                        ent_DlgItems[i].DspValue=ic_realloc_char(ent_DlgItems[i].DspValue,strlen(m_GenLayer)+1);
                        strcpy(ent_DlgItems[i].DspValue,m_GenLayer);
                    }
                    break;
                case GEN_LINETYPE:
                    if(ent_DlgItems[i].DspValue!=NULL && !strisame(m_GenLinetype,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ))) {
                        ent_DlgItems[i].DspValue=ic_realloc_char(ent_DlgItems[i].DspValue,strlen(m_GenLinetype)+1);
                        strcpy(ent_DlgItems[i].DspValue,m_GenLinetype);
                    }
                    break;
                case GEN_LTSCALE:
                    if(ent_DlgItems[i].DspValue!=NULL && m_GenLTScale.CompareNoCase(ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ))) {
                        if(m_GenLTScale.IsEmpty()) {
                            if(ent_DlgItems[i].DspValue!=NULL){
                                IC_FREE(ent_DlgItems[i].DspValue);
                                ent_DlgItems[i].DspValue=NULL;
                            }
                        }else{
                            ent_DlgItems[i].DspValue=ic_realloc_char(ent_DlgItems[i].DspValue,m_GenLTScale.GetLength()+1);
                            strcpy(ent_DlgItems[i].DspValue,(LPCTSTR)m_GenLTScale);
                        }
                    }
                    break;
                case GEN_THICKNESS:
                    if(ent_DlgItems[i].DspValue!=NULL && m_GenThick.CompareNoCase(ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ))) {
                        if(m_GenThick.IsEmpty()) {
                            if(ent_DlgItems[i].DspValue!=NULL){
                                IC_FREE(ent_DlgItems[i].DspValue);
                                ent_DlgItems[i].DspValue=NULL;
                            }
                        }else{
                            ent_DlgItems[i].DspValue=ic_realloc_char(ent_DlgItems[i].DspValue,m_GenThick.GetLength()+1);
                            strcpy(ent_DlgItems[i].DspValue,(LPCTSTR)m_GenThick);
                        }
                    }
                    break;
                case GEN_COLOR:
                    if(m_GenColor!=-1) {
                        ent_DlgItems[i].SColor=m_GenColor;
                    }
                    break;
				// EBATECH(CNBR) -[ 31-03-2003 Bugzilla#78471 Support Lineweight
                case GEN_LW:
                    if(0 <= m_GenLweight && m_GenLweight < 27) {
                        ent_DlgItems[i].SColor=m_GenLweight;
                    }
                    break;
                // EBATECH(CNBR) ]-
            }
        }
    }
}

//Set the layer box variable
void ent_EntityProperties::ent_GetLayer() {
    BOOL DoOnce=0;
    int i;

    for(i=0;i<ent_num_of_vars;i++) {
        if(ent_DlgItems[i].ID==GEN_LAYER) {
            if(ent_DlgItems[i].DspValue!=NULL) {
                if(!DoOnce) {
                    strncpy(m_GenLayer,ent_DlgItems[i].DspValue,sizeof(m_GenLayer)-1);
                    if(strisame(m_GenLayer,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ))) break;
                    DoOnce=1;
                }else{
                    if(!strisame(m_GenLayer,ent_DlgItems[i].DspValue)) {
                        strcpy(m_GenLayer,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ));
                        break;
                    }
                }
            }
        }
    }
}

//Set the linetype box variable
void ent_EntityProperties::ent_GetLinetype() {
    BOOL DoOnce=0;
    int i;

    for(i=0;i<ent_num_of_vars;i++) {
        if(ent_DlgItems[i].ID==GEN_LINETYPE) {
            if(ent_DlgItems[i].DspValue!=NULL) {
                if(!DoOnce) {
                    strncpy(m_GenLinetype,ent_DlgItems[i].DspValue,sizeof(m_GenLinetype)-1);
                    if(strisame(m_GenLinetype,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ))) break;
                    DoOnce=1;
                }else{
                    if(!strisame(m_GenLinetype,ent_DlgItems[i].DspValue)) {
                        strcpy(m_GenLinetype,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ));
                        break;
                    }
                }
            }
        }
    }
}

//Set the ltscale
void ent_EntityProperties::ent_GetLTScale() {
    BOOL DoOnce=0;
    int i;

    for(i=0;i<ent_num_of_vars;i++) {
        if(ent_DlgItems[i].ID==GEN_LTSCALE) {
            if(ent_DlgItems[i].DspValue!=NULL) {
                if(!DoOnce) {
                    m_GenLTScale=ent_DlgItems[i].DspValue;
                    if(!m_GenLTScale.CompareNoCase(ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ))) break;
                    DoOnce=1;
                }else{
                    if(m_GenLTScale.CompareNoCase(ent_DlgItems[i].DspValue)) {
                        m_GenLTScale=ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" );
                        break;
                    }
                }
            }
        }
    }
}

//Set the thickness
void ent_EntityProperties::ent_GetThickness() {
    BOOL DoOnce=0;
    int i;

    for(i=0;i<ent_num_of_vars;i++) {
        if(ent_DlgItems[i].ID==GEN_THICKNESS) {
            if(ent_DlgItems[i].DspValue!=NULL) {
                if(!DoOnce) {
                    m_GenThick=ent_DlgItems[i].DspValue;
                    if(!m_GenThick.CompareNoCase(ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ))) break;
                    DoOnce=1;
                }else{
                    if(m_GenThick.CompareNoCase(ent_DlgItems[i].DspValue)) {
                        m_GenThick=ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" );
                        break;
                    }
                }
            }
        }
    }
}

//Set the color
void ent_EntityProperties::ent_GetColor() {
    BOOL DoOnce=0;
    int i;

    for(i=0;i<ent_num_of_vars;i++) {
        if(ent_DlgItems[i].ID==GEN_COLOR) {
            if(ent_DlgItems[i].SColor!=-99) {
                if(!DoOnce) {
                    m_GenColor=ent_DlgItems[i].SColor;
                    if(m_GenColor==-1) break;
                    DoOnce=1;
                }else{
                    if(ent_DlgItems[i].SColor!=m_GenColor) {
                        m_GenColor=-1;
                        break;
                    }
                }
            }
        }
    }
}

// EBATECH(CNBR) -[ 31-03-2003 Bugzilla#78471 Support Lineweight
//Set the lweight
void ent_EntityProperties::ent_GetLweight() {
    BOOL DoOnce=0;
    int i;

    for(i=0;i<ent_num_of_vars;i++) {
        if(ent_DlgItems[i].ID==GEN_LW) {
            if(ent_DlgItems[i].SColor!=-99) {
                if(!DoOnce) {
                    m_GenLweight=ent_DlgItems[i].SColor;
                    if (m_GenLweight < 0 || m_GenLweight > 27)
                    	break;
                    DoOnce=1;
                }else{
                    if(ent_DlgItems[i].SColor!=m_GenLweight) {
                        m_GenLweight = 27;
                        break;
                    }
                }
            }
        }
    }
}

void ent_EntityProperties::ent_LweightChoice()
{
    CString csTmp;
    // switch message group depending on $LWUNITS
	resbuf rb;
	int top = 1;
	if( SDS_getvar(NULL,DB_QLWUNITS,&rb,SDS_CURDWG,&SDS_CURCFG,&SDS_CURSES) == RTNORM )
		top = rb.resval.rint;
	top = ( top == 1 ? IDC_COMBO_M_LWDEFAULT : IDC_COMBO_I_LWDEFAULT );

	::SendMessage(::GetDlgItem(m_hWnd,GEN_LW),CB_RESETCONTENT,0,0);

	for(int i = 0 ; i <= 27 ; i++ ) {
		// alternative message when resource string can't load.
		csTmp.Format("LWeight %d", i - 3);
		if( i == 27)
			csTmp = ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" );

		::SendMessage(::GetDlgItem(m_hWnd,GEN_LW),CB_ADDSTRING,0,(LPARAM)ResourceString(top + i, csTmp ));
	}
}
// EBATECH(CNBR) ]-

//This will read in the layer and linetype choices
//into the drop down list.
//mode=TRUE for layer and FALSE for linetype
void ent_EntityProperties::ent_LayerLineChoice(BOOL mode) {
    CString csTmp;

	if(mode) {
	    ::SendMessage(::GetDlgItem(m_hWnd,GEN_LAYER),CB_RESETCONTENT,0,0);
        SDS_StartTblRead("LAYER"/*DNT*/);
	    while(SDS_TblReadHasMore()) {
    	    csTmp=SDS_TblReadString();
            if(csTmp.Find('|')>0) continue;
            ::SendMessage(::GetDlgItem(m_hWnd,GEN_LAYER),CB_ADDSTRING,0,(LPARAM)(LPCTSTR)csTmp);
        }
        if(strisame(m_GenLayer,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ))) ::SendMessage(::GetDlgItem(m_hWnd,GEN_LAYER),CB_ADDSTRING,0,(LPARAM)ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ));
	}else{
	    ::SendMessage(::GetDlgItem(m_hWnd,GEN_LINETYPE),CB_RESETCONTENT,0,0);
//Changed by Vitaly Spirin        SDS_StartTblRead(ResourceString(IDC_ICADENTPROP_LTYPE_25, "LTYPE" ));
        SDS_StartTblRead("LTYPE");
	    while(SDS_TblReadHasMore()) {
    	    csTmp=SDS_TblReadString();
            if(csTmp.Find('|')>0) continue;
    	    ::SendMessage(::GetDlgItem(m_hWnd,GEN_LINETYPE),CB_ADDSTRING,0,(LPARAM)(LPCTSTR)csTmp);
        }
        if(strisame(m_GenLinetype,ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ))) ::SendMessage(::GetDlgItem(m_hWnd,GEN_LINETYPE),CB_ADDSTRING,0,(LPARAM)ResourceString(IDC_ICADENTPROP_VARIES_18, "Varies" ));
    }
}


//This is for a tab change
void ent_EntityProperties::OnTabChange(NMHDR *pNotifyStruct,LRESULT *result) {

    //Disable
    switch(m_TabIndex[m_PrvSel]) {
        case ENT_3DFACE:
            m_3DFACE_TAB.EnableWindow(FALSE);
            m_3DFACE_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_ARC:
            m_ARC_TAB.EnableWindow(FALSE);
            m_ARC_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_ATTDEF:
            m_ATTDEF_TAB.EnableWindow(FALSE);
            m_ATTDEF_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_ATTRIB:
            m_ATTRIB_TAB.EnableWindow(FALSE);
            m_ATTRIB_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_CIRCLE:
            m_CIRCLE_TAB.EnableWindow(FALSE);
            m_CIRCLE_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_DIMENSION:
            m_DIM_TAB.EnableWindow(FALSE);
            m_DIM_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_ELP:
            m_ELP_TAB.EnableWindow(FALSE);
            m_ELP_TAB.ShowWindow(SW_HIDE);
            break;
        //Modified Cybage MM 24-09-2001 DD-MM-YYYY [
		//Reason : Bug No.- 77847 from Bugzilla
		case ENT_IMAGE:
            m_IMAGE_TAB.EnableWindow(FALSE);
            m_IMAGE_TAB.ShowWindow(SW_HIDE);
			EnableControlsForImage(TRUE);
            break;
		//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]
        case ENT_INSERT:
            m_INSERT_TAB.EnableWindow(FALSE);
            m_INSERT_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_LEADER:
            m_LEADER_TAB.EnableWindow(FALSE);
            m_LEADER_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_LINE:
            m_LINE_TAB.EnableWindow(FALSE);
            m_LINE_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_MLINE:
            m_MLINE_TAB.EnableWindow(FALSE);
            m_MLINE_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_MTEXT:
            m_MTEXT_TAB.EnableWindow(FALSE);
            m_MTEXT_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_POLYLINE:
            m_PLINE_TAB.EnableWindow(FALSE);
            m_PLINE_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_LWPOLYLINE:
            m_LWPLINE_TAB.EnableWindow(FALSE);
            m_LWPLINE_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_POINT:
            m_POINT_TAB.EnableWindow(FALSE);
            m_POINT_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_RAY:
            m_RAY_TAB.EnableWindow(FALSE);
            m_RAY_TAB.ShowWindow(SW_HIDE);
            break;
        //EBATECH(CNBR) -[ 2002/4/24
		case ENT_SHAPE:
            m_SHAPE_TAB.EnableWindow(FALSE);
            m_SHAPE_TAB.ShowWindow(SW_HIDE);
            break;
		//EBATECH(CNBR) ]-
        case ENT_SOLID:
            m_SOLID_TAB.EnableWindow(FALSE);
            m_SOLID_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_SPLINE:
            m_SPLINE_TAB.EnableWindow(FALSE);
            m_SPLINE_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_TEXT:
            m_TEXT_TAB.EnableWindow(FALSE);
            m_TEXT_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_TOLERANCE:
            m_TOLER_TAB.EnableWindow(FALSE);
            m_TOLER_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_TRACE:
            m_TRACE_TAB.EnableWindow(FALSE);
            m_TRACE_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_VIEWPORT:
            m_VIEWP_TAB.EnableWindow(FALSE);
            m_VIEWP_TAB.ShowWindow(SW_HIDE);
            break;
        case ENT_XLINE:
            m_XLINE_TAB.EnableWindow(FALSE);
            m_XLINE_TAB.ShowWindow(SW_HIDE);
            break;
		case ENT_HATCH:
			m_HATCH_TAB.EnableWindow(FALSE);
			m_HATCH_TAB.ShowWindow(SW_HIDE);
			EnableControlsForHatch(TRUE);
			break;
		case ENT_3DSOLID:
			m_3DSOLID_TAB.EnableWindow(FALSE);
			m_3DSOLID_TAB.ShowWindow(SW_HIDE);
			break;
		case ENT_REGION:
			m_REGION_TAB.EnableWindow(FALSE);
			m_REGION_TAB.ShowWindow(SW_HIDE);
			break;
		case ENT_BODY:
			m_BODY_TAB.EnableWindow(FALSE);
			m_BODY_TAB.ShowWindow(SW_HIDE);
			break;
    }

    //Enable
    m_PrvSel=m_CurSel=m_TabCtrl.GetCurSel(); //Get the current selection
    switch(m_TabIndex[m_CurSel]) {
        case ENT_3DFACE:
            if (!m_3DFACE_TAB) m_3DFACE_TAB.Create(ENT_3DFACE_TAB,this);
            m_3DFACE_TAB.EnableWindow(TRUE);
            m_3DFACE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_ARC:
            if (!m_ARC_TAB) m_ARC_TAB.Create(ENT_ARC_TAB,this);
            m_ARC_TAB.EnableWindow(TRUE);
            m_ARC_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_ATTDEF:
            if (!m_ATTDEF_TAB) m_ATTDEF_TAB.Create(ENT_ATTDEF_TAB,this);
            m_ATTDEF_TAB.EnableWindow(TRUE);
            m_ATTDEF_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_ATTRIB:
            if (!m_ATTRIB_TAB) m_ATTRIB_TAB.Create(ENT_ATTRIB_TAB,this);
            m_ATTRIB_TAB.EnableWindow(TRUE);
            m_ATTRIB_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_CIRCLE:
            if (!m_CIRCLE_TAB) m_CIRCLE_TAB.Create(ENT_CIRCLE_TAB,this);
            m_CIRCLE_TAB.EnableWindow(TRUE);
            m_CIRCLE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_DIMENSION:
            if (!m_DIM_TAB) m_DIM_TAB.Create(ENT_DIM_TAB,this);
            m_DIM_TAB.EnableWindow(TRUE);
            m_DIM_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_ELP:
            if (!m_ELP_TAB) m_ELP_TAB.Create(ENT_ELLIPSE_TAB,this);
            m_ELP_TAB.EnableWindow(TRUE);
            m_ELP_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        //Modified Cybage MM 24-09-2001 DD-MM-YYYY [
		//Reason : Bug No.- 77847 from Bugzilla
		case ENT_IMAGE:
            if (!m_IMAGE_TAB){
				m_IMAGE_TAB.Create(ENT_IMAGE_TAB,this);
			}
			m_IMAGE_TAB.EnableWindow(TRUE);
            m_IMAGE_TAB.ShowWindow(SW_SHOWNORMAL);
			EnableControlsForImage(FALSE);
            break;
		//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]
        case ENT_INSERT:
            if (!m_INSERT_TAB) m_INSERT_TAB.Create(ENT_INSERT_TAB,this);
            m_INSERT_TAB.EnableWindow(TRUE);
            m_INSERT_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_LEADER:
            if (!m_LEADER_TAB) m_LEADER_TAB.Create(ENT_LEADER_TAB,this);
            m_LEADER_TAB.EnableWindow(TRUE);
            m_LEADER_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_LINE:
            if (!m_LINE_TAB) m_LINE_TAB.Create(ENT_LINE_TAB,this);
            m_LINE_TAB.EnableWindow(TRUE);
            m_LINE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_MLINE:
            if (!m_MLINE_TAB) m_MLINE_TAB.Create(ENT_MLINE_TAB,this);
            m_MLINE_TAB.EnableWindow(TRUE);
            m_MLINE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_MTEXT:
            if (!m_MTEXT_TAB) m_MTEXT_TAB.Create(ENT_MTEXT_TAB,this);
            m_MTEXT_TAB.EnableWindow(TRUE);
            m_MTEXT_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_POLYLINE:
            if (!m_PLINE_TAB) m_PLINE_TAB.Create(ENT_PLINE_TAB,this);
            m_PLINE_TAB.EnableWindow(TRUE);
            m_PLINE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_LWPOLYLINE:
            if (!m_LWPLINE_TAB) m_LWPLINE_TAB.Create(ENT_LWPLINE_TAB,this);
            m_LWPLINE_TAB.EnableWindow(TRUE);
            m_LWPLINE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_POINT:
            if (!m_POINT_TAB) m_POINT_TAB.Create(ENT_POINT_TAB,this);
            m_POINT_TAB.EnableWindow(TRUE);
            m_POINT_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_RAY:
            if (!m_RAY_TAB) m_RAY_TAB.Create(ENT_RAY_TAB,this);
            m_RAY_TAB.EnableWindow(TRUE);
            m_RAY_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
		//EBATECH(CNBR) -[ 2002/4/24
		case ENT_SHAPE:
            if (!m_SHAPE_TAB){
				m_SHAPE_TAB.Create(ENT_SHAPE_TAB,this);
			}
			m_SHAPE_TAB.EnableWindow(TRUE);
            m_SHAPE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
		//EBATECH(CNBR) ]-
        case ENT_SOLID:
            if (!m_SOLID_TAB) m_SOLID_TAB.Create(ENT_SOLID_TAB,this);
            m_SOLID_TAB.EnableWindow(TRUE);
            m_SOLID_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_SPLINE:
            if (!m_SPLINE_TAB) m_SPLINE_TAB.Create(ENT_SPLINE_TAB,this);
            m_SPLINE_TAB.EnableWindow(TRUE);
            m_SPLINE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_TEXT:
            if (!m_TEXT_TAB) m_TEXT_TAB.Create(ENT_TEXT_TAB,this);
            m_TEXT_TAB.EnableWindow(TRUE);
            m_TEXT_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_TOLERANCE:
            if (!m_TOLER_TAB) m_TOLER_TAB.Create(ENT_TOLER_TAB,this);
            m_TOLER_TAB.EnableWindow(TRUE);
            m_TOLER_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_TRACE:
            if (!m_TRACE_TAB) m_TRACE_TAB.Create(ENT_TRACE_TAB,this);
            m_TRACE_TAB.EnableWindow(TRUE);
            m_TRACE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_VIEWPORT:
            if (!m_VIEWP_TAB) m_VIEWP_TAB.Create(ENT_VIEWP_TAB,this);
            m_VIEWP_TAB.EnableWindow(TRUE);
            m_VIEWP_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_XLINE:
            if (!m_XLINE_TAB) m_XLINE_TAB.Create(ENT_XLINE_TAB,this);
            m_XLINE_TAB.EnableWindow(TRUE);
            m_XLINE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
		case ENT_HATCH:
			if (!m_HATCH_TAB)
				m_HATCH_TAB.Create(ENT_HATCH_TAB,this);

			m_HATCH_TAB.EnableWindow(TRUE);
			m_HATCH_TAB.ShowWindow(SW_SHOWNORMAL);
			EnableControlsForHatch(FALSE);
			break;
		case ENT_3DSOLID:
			if(!m_3DSOLID_TAB)
				m_3DSOLID_TAB.Create(ENT_3DSOLID_TAB, this);

			m_3DSOLID_TAB.EnableWindow(TRUE);
			m_3DSOLID_TAB.ShowWindow(SW_SHOWNORMAL);
			break;
		case ENT_REGION:
			if(!m_REGION_TAB)
				m_REGION_TAB.Create(ENT_REGION_TAB, this);

			m_REGION_TAB.EnableWindow(TRUE);
			m_REGION_TAB.ShowWindow(SW_SHOWNORMAL);
			break;
		case ENT_BODY:
			if(!m_BODY_TAB)
				m_BODY_TAB.Create(ENT_BODY_TAB, this);

			m_BODY_TAB.EnableWindow(TRUE);
			m_BODY_TAB.ShowWindow(SW_SHOWNORMAL);
			break;
    }
}

void ent_EntityProperties::OnEditLink()
{
	m_editHL.setApplyLater(true);
	if(m_editHL.DoModal() == IDOK)
	{
		if(m_editHL.description().IsEmpty())
			m_linkDesc = ResourceString(IDC_HYPERLINK_DESCRIPTION_NONE, "Link Description: None" );	//EBATECH(localize)
		else
			m_linkDesc.Format(ResourceString(IDC_HYPERLINK_DESCRIPTION, "Link Description: %s" ), m_editHL.description()); //EBATECH(localize)
		GetDlgItem(GEN_HYPERLINK_DESC)->SetWindowText(m_linkDesc);
	}
	else
		m_editHL.setApplyLater(false);
}

BOOL ent_EntityProperties::OnInitDialog() {
	extern HWND SDS_hWndExplorerCaller;
	SDS_hWndExplorerCaller = m_hWnd;

    int index=0,count=0;
    TC_ITEM TabCtrlItem;
    long i;
    BOOL ret;
	//Modified Cybage AW 06-04-01
	CWnd *wnd = NULL;

    //This will fill the drop down list will all
    //available linetypes and layers plus add "Varies"
    //if the member variable is "Varies".
    //Because this function uses sendmessage
    //we must wait untill after the create before
    //calling this function.
    ent_LayerLineChoice(TRUE); //Layer
    ent_LayerLineChoice(FALSE); //Linetype
	ent_LweightChoice(); // LWeight

    ret=IcadDialog::OnInitDialog();

	// DP
#ifndef _SUPPORT_HYPERLINKS_
	GetDlgItem(GEN_HYPERLINK_DESC)->ShowWindow(SW_HIDE);
	GetDlgItem(GEN_HYPERLINK_PICK)->ShowWindow(SW_HIDE);
#endif
	GetDlgItem(GEN_HYPERLINK_DESC)->SetWindowText(m_linkDesc);

    TabCtrlItem.mask=TCIF_TEXT;

	EditString	itemText;

    for(i=0;i<ent_num_of_vars;i++)
	{
        if(ent_DlgItems[i].pRbll)
		{
            switch(ent_DlgItems[i].EntTyp)
			{
                case DB_3DFACE:
                    if(m_TabsFlag & ENT_3DFACE) break;
                    itemText = ResourceString(IDC_ICADENTPROP_3DFACE_26, "3DFace" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_3DFACE;
                    m_TabIndex[count]=ENT_3DFACE;
                    count++;
                    break;
                case DB_ARC:
                    if(m_TabsFlag & ENT_ARC) break;
                    itemText = ResourceString(IDC_ICADENTPROP_ARC_27, "Arc" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_ARC;
                    m_TabIndex[count]=ENT_ARC;
                    count++;
                    break;
                case DB_ATTDEF:
                    if(m_TabsFlag & ENT_ATTDEF) break;
                    itemText = ResourceString(IDC_ICADENTPROP_ATTRIBUTE_D_28, "Attribute Definition" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_ATTDEF;
                    m_TabIndex[count]=ENT_ATTDEF;
                    count++;
                    break;
                case DB_ATTRIB:
                    if(m_TabsFlag & ENT_ATTRIB) break;
                    itemText = ResourceString(IDC_ICADENTPROP_ATTRIBUTE_29, "Attribute" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_ATTRIB;
                    m_TabIndex[count]=ENT_ATTRIB;
                    count++;
                    break;
                case DB_CIRCLE:
                    if(m_TabsFlag & ENT_CIRCLE) break;
                    itemText = ResourceString(IDC_ICADENTPROP_CIRCLE_30, "Circle" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_CIRCLE;
                    m_TabIndex[count]=ENT_CIRCLE;
                    count++;
                    break;
                case DB_DIMENSION:
                    if(m_TabsFlag & ENT_DIMENSION) break;
					//Modified Cybage AW 06-04-01 [
					//Reason : For dimensions, disable thickness edit ctrl when
					//done entprop
					wnd = GetDlgItem(GEN_THICKNESS);
					if(wnd) wnd->EnableWindow(FALSE);
					//Modified Cybage AW 06-04-01 ]
                    itemText = ResourceString(IDC_ICADENTPROP_DIMENSION_2, "Dimension" ); // EBATECH
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_DIMENSION;
                    m_TabIndex[count]=ENT_DIMENSION;
                    count++;
                    break;
                case DB_ELLIPSE:
                    if(m_TabsFlag & ENT_ELP) break;
                    itemText = ResourceString(IDC_ICADENTPROP_ELLIPSE_31, "Ellipse" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_ELP;
                    m_TabIndex[count]=ENT_ELP;
                    count++;
                    break;
                //Modified Cybage MM 24-09-2001 DD-MM-YYYY [
				//Reason : Bug No.- 77847 from Bugzilla
				case DB_IMAGE:
                    if(m_TabsFlag & ENT_IMAGE) break;
                    itemText = ResourceString(IDC_ICADENTPROP__IMAGE_69, "Image" );
					EnableControlsForImage(FALSE);
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_IMAGE;
                    m_TabIndex[count]=ENT_IMAGE;
                    count++;
                    break;
				//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]
                case DB_INSERT:
                    if(m_TabsFlag & ENT_INSERT) break;
                    itemText = ResourceString(IDC_ICADENTPROP_INSERT_32, "Insert" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_INSERT;
                    m_TabIndex[count]=ENT_INSERT;
                    count++;
                    break;
                case DB_LEADER:
                    if(m_TabsFlag & ENT_LEADER) break;
                    itemText = ResourceString(IDC_ICADENTPROP_LEADER_33, "Leader" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_LEADER;
                    m_TabIndex[count]=ENT_LEADER;
                    count++;
                    break;
                case DB_LINE:
                    if(m_TabsFlag & ENT_LINE) break;
                    itemText = ResourceString(IDC_ICADENTPROP_LINE_34, "Line" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_LINE;
                    m_TabIndex[count]=ENT_LINE;
                    count++;
                    break;
                case DB_MLINE:
                    if(m_TabsFlag & ENT_MLINE) break;
                    itemText = ResourceString(IDC_ICADENTPROP_MLINE_35, "MLine" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_MLINE;
                    m_TabIndex[count]=ENT_MLINE;
                    count++;
                    break;
                case DB_MTEXT:
                    if(m_TabsFlag & ENT_MTEXT) break;
                    itemText = ResourceString(IDC_ICADENTPROP_MTEXT_36, "MText" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_MTEXT;
                    m_TabIndex[count]=ENT_MTEXT;
                    count++;
                    break;
                case DB_POLYLINE:
                    if(m_TabsFlag & ENT_POLYLINE) break;
                    itemText = ResourceString(IDC_ICADENTPROP_POLYLINE_37, "Polyline" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_POLYLINE;
                    m_TabIndex[count]=ENT_POLYLINE;
                    count++;
                    break;
                case DB_LWPOLYLINE:
                    if(m_TabsFlag & ENT_LWPOLYLINE) break;
                    itemText = ResourceString(IDC_ICADENTPROP_LWPOLYLINE, "Lightweight Polyline" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_LWPOLYLINE;
                    m_TabIndex[count]=ENT_LWPOLYLINE;
                    count++;
                    break;
                case DB_POINT:
                    if(m_TabsFlag & ENT_POINT) break;
                    itemText = ResourceString(IDC_ICADENTPROP_POINT_38, "Point" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_POINT;
                    m_TabIndex[count]=ENT_POINT;
                    count++;
                    break;
                case DB_RAY:
                    if(m_TabsFlag & ENT_RAY) break;
                    itemText = ResourceString(IDC_ICADENTPROP_RAY_39, "Ray" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_RAY;
                    m_TabIndex[count]=ENT_RAY;
                    count++;
                    break;
                // EBATECH(CNBR) -[ 2002/4/24
                case DB_SHAPE:
                    if(m_TabsFlag & ENT_SHAPE) break;
                    itemText = ResourceString(IDC_ICADENTPROP_SHAPE_47, "Shape" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_SHAPE;
                    m_TabIndex[count]=ENT_SHAPE;
                    count++;
                    break;
                // EBATECH(CNBR) ]-
                case DB_SOLID:
                    if(m_TabsFlag & ENT_SOLID) break;
                    itemText = ResourceString(IDC_ICADENTPROP_SOLID_40, "Solid" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_SOLID;
                    m_TabIndex[count]=ENT_SOLID;
                    count++;
                    break;
                case DB_SPLINE:
                    if(m_TabsFlag & ENT_SPLINE) break;
                    itemText = ResourceString(IDC_ICADENTPROP_SPLINE_41, "Spline" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_SPLINE;
                    m_TabIndex[count]=ENT_SPLINE;
                    count++;
                    break;
                case DB_TEXT:
                    if(m_TabsFlag & ENT_TEXT) break;
                    itemText = ResourceString(IDC_ICADENTPROP_TEXT_42, "Text" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_TEXT;
                    m_TabIndex[count]=ENT_TEXT;
                    count++;
                    break;
                case DB_TOLERANCE:
                    if(m_TabsFlag & ENT_TOLERANCE) break;
                    itemText = ResourceString(IDC_ICADENTPROP_TOLERANCE_43, "Tolerance" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_TOLERANCE;
                    m_TabIndex[count]=ENT_TOLERANCE;
                    count++;
                    break;
                case DB_TRACE:
                    if(m_TabsFlag & ENT_TRACE) break;
                    itemText = ResourceString(IDC_ICADENTPROP_TRACE_44, "Trace" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_TRACE;
                    m_TabIndex[count]=ENT_TRACE;
                    count++;
                    break;
                case DB_VIEWPORT:
                    if(m_TabsFlag & ENT_VIEWPORT) break;
                    itemText = ResourceString(IDC_ICADENTPROP_VIEWPORT_45, "Viewport" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_VIEWPORT;
                    m_TabIndex[count]=ENT_VIEWPORT;
                    count++;
                    break;
                case DB_XLINE:
                    if(m_TabsFlag & ENT_XLINE) break;
                    itemText = ResourceString(IDC_ICADENTPROP_XLINE_46, "Xline" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_XLINE;
                    m_TabIndex[count]=ENT_XLINE;
                    count++;
                    break;

				case DB_HATCH:
					if (m_TabsFlag & ENT_HATCH)
						break;

                    itemText = ResourceString(IDC_ICADENTPROP_HATCH_LOW, "Hatch" );
					TabCtrlItem.pszText= itemText;
                    m_TabCtrl.InsertItem(index,&TabCtrlItem);
                    index++;
                    m_TabsFlag|=ENT_HATCH;
                    m_TabIndex[count]=ENT_HATCH;
                    count++;
					break;
				case DB_3DSOLID:
					if(m_TabsFlag & ENT_3DSOLID)
						break;

                    itemText = ResourceString(IDC_ICADENTPROP_3DSOLID, "3dSolid" );
					TabCtrlItem.pszText = itemText;
                    m_TabCtrl.InsertItem(index, &TabCtrlItem);
                    ++index;
                    m_TabsFlag |= ENT_3DSOLID;
                    m_TabIndex[count] = ENT_3DSOLID;
                    ++count;
					break;
				case DB_REGION:
					if(m_TabsFlag & ENT_REGION)
						break;

                    itemText = ResourceString(IDC_ICADENTPROP_REGION, "Region" );
					TabCtrlItem.pszText = itemText;
                    m_TabCtrl.InsertItem(index, &TabCtrlItem);
                    ++index;
                    m_TabsFlag |= ENT_REGION;
                    m_TabIndex[count] = ENT_REGION;
                    ++count;
					break;
				case DB_BODY:
					if(m_TabsFlag & ENT_BODY)
						break;

                    itemText = ResourceString(IDC_ICADENTPROP_BODY, "Body" );
					TabCtrlItem.pszText = itemText;
                    m_TabCtrl.InsertItem(index, &TabCtrlItem);
                    ++index;
                    m_TabsFlag |= ENT_BODY;
                    m_TabIndex[count] = ENT_BODY;
                    ++count;
					break;
            }	// switch
        }	// if
    }	// for

    m_TabCtrl.SetCurSel(m_PrvSel);
    switch(m_TabIndex[m_PrvSel]) {
        case ENT_3DFACE:
            if (!m_3DFACE_TAB) m_3DFACE_TAB.Create(ENT_3DFACE_TAB,this);
            m_3DFACE_TAB.EnableWindow(TRUE);
            m_3DFACE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_ARC:
            if (!m_ARC_TAB) m_ARC_TAB.Create(ENT_ARC_TAB,this);
            m_ARC_TAB.EnableWindow(TRUE);
            m_ARC_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_ATTDEF:
            if (!m_ATTDEF_TAB) m_ATTDEF_TAB.Create(ENT_ATTDEF_TAB,this);
            m_ATTDEF_TAB.EnableWindow(TRUE);
            m_ATTDEF_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_ATTRIB:
            if (!m_ATTRIB_TAB) m_ATTRIB_TAB.Create(ENT_ATTRIB_TAB,this);
            m_ATTRIB_TAB.EnableWindow(TRUE);
            m_ATTRIB_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_CIRCLE:
            if (!m_CIRCLE_TAB) m_CIRCLE_TAB.Create(ENT_CIRCLE_TAB,this);
            m_CIRCLE_TAB.EnableWindow(TRUE);
            m_CIRCLE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_DIMENSION:
            if (!m_DIM_TAB) m_DIM_TAB.Create(ENT_DIM_TAB,this);
            m_DIM_TAB.EnableWindow(TRUE);
            m_DIM_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_ELP:
            if (!m_ELP_TAB) m_ELP_TAB.Create(ENT_ELLIPSE_TAB,this);
            m_ELP_TAB.EnableWindow(TRUE);
            m_ELP_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        //Modified Cybage MM 24-09-2001 DD-MM-YYYY [
		//Reason : Bug No.- 77847 from Bugzilla
		case ENT_IMAGE:
            if (!m_IMAGE_TAB){
				m_IMAGE_TAB.Create(ENT_IMAGE_TAB,this);
			}
			m_IMAGE_TAB.EnableWindow(TRUE);
            m_IMAGE_TAB.ShowWindow(SW_SHOWNORMAL);
			EnableControlsForImage(FALSE);
            break;
		//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]
        case ENT_INSERT:
            if (!m_INSERT_TAB) m_INSERT_TAB.Create(ENT_INSERT_TAB,this);
            m_INSERT_TAB.EnableWindow(TRUE);
            m_INSERT_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_LEADER:
            if (!m_LEADER_TAB) m_LEADER_TAB.Create(ENT_LEADER_TAB,this);
            m_LEADER_TAB.EnableWindow(TRUE);
            m_LEADER_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_LINE:
            if (!m_LINE_TAB) m_LINE_TAB.Create(ENT_LINE_TAB,this);
            m_LINE_TAB.EnableWindow(TRUE);
            m_LINE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_MLINE:
            if (!m_MLINE_TAB) m_MLINE_TAB.Create(ENT_MLINE_TAB,this);
            m_MLINE_TAB.EnableWindow(TRUE);
            m_MLINE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_MTEXT:
            if (!m_MTEXT_TAB) m_MTEXT_TAB.Create(ENT_MTEXT_TAB,this);
            m_MTEXT_TAB.EnableWindow(TRUE);
            m_MTEXT_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_POLYLINE:
            if (!m_PLINE_TAB) m_PLINE_TAB.Create(ENT_PLINE_TAB,this);
            m_PLINE_TAB.EnableWindow(TRUE);
            m_PLINE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_LWPOLYLINE:
            if (!m_LWPLINE_TAB) m_LWPLINE_TAB.Create(ENT_LWPLINE_TAB,this);
            m_LWPLINE_TAB.EnableWindow(TRUE);
            m_LWPLINE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_POINT:
            if (!m_POINT_TAB) m_POINT_TAB.Create(ENT_POINT_TAB,this);
            m_POINT_TAB.EnableWindow(TRUE);
            m_POINT_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_RAY:
            if (!m_RAY_TAB) m_RAY_TAB.Create(ENT_RAY_TAB,this);
            m_RAY_TAB.EnableWindow(TRUE);
            m_RAY_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        // EBATECH(CNBR) -[ 2002/4/24
        case ENT_SHAPE:
            if (!m_SHAPE_TAB) m_SHAPE_TAB.Create(ENT_SHAPE_TAB,this);
            m_SHAPE_TAB.EnableWindow(TRUE);
            m_SHAPE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        // EBATECH(CNBR) ]-
        case ENT_SOLID:
            if (!m_SOLID_TAB) m_SOLID_TAB.Create(ENT_SOLID_TAB,this);
            m_SOLID_TAB.EnableWindow(TRUE);
            m_SOLID_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_SPLINE:
            if (!m_SPLINE_TAB) m_SPLINE_TAB.Create(ENT_SPLINE_TAB,this);
            m_SPLINE_TAB.EnableWindow(TRUE);
            m_SPLINE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_TEXT:
            if (!m_TEXT_TAB) m_TEXT_TAB.Create(ENT_TEXT_TAB,this);
            m_TEXT_TAB.EnableWindow(TRUE);
            m_TEXT_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_TOLERANCE:
            if (!m_TOLER_TAB) m_TOLER_TAB.Create(ENT_TOLER_TAB,this);
            m_TOLER_TAB.EnableWindow(TRUE);
            m_TOLER_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_TRACE:
            if (!m_TRACE_TAB) m_TRACE_TAB.Create(ENT_TRACE_TAB,this);
            m_TRACE_TAB.EnableWindow(TRUE);
            m_TRACE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_VIEWPORT:
            if (!m_VIEWP_TAB) m_VIEWP_TAB.Create(ENT_VIEWP_TAB,this);
            m_VIEWP_TAB.EnableWindow(TRUE);
            m_VIEWP_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
        case ENT_XLINE:
            if (!m_XLINE_TAB) m_XLINE_TAB.Create(ENT_XLINE_TAB,this);
            m_XLINE_TAB.EnableWindow(TRUE);
            m_XLINE_TAB.ShowWindow(SW_SHOWNORMAL);
            break;
		case ENT_HATCH:
			if (!m_HATCH_TAB)
				m_HATCH_TAB.Create(ENT_HATCH_TAB,this);

			m_HATCH_TAB.EnableWindow(TRUE);
			m_HATCH_TAB.ShowWindow(SW_SHOWNORMAL);
			break;
		case ENT_3DSOLID:
			if(!m_3DSOLID_TAB)
				m_3DSOLID_TAB.Create(ENT_3DSOLID_TAB, this);

			m_3DSOLID_TAB.EnableWindow(TRUE);
			m_3DSOLID_TAB.ShowWindow(SW_SHOWNORMAL);
			break;
		case ENT_REGION:
			if(!m_REGION_TAB)
				m_REGION_TAB.Create(ENT_REGION_TAB, this);

			m_REGION_TAB.EnableWindow(TRUE);
			m_REGION_TAB.ShowWindow(SW_SHOWNORMAL);
			break;
		case ENT_BODY:
			if(!m_BODY_TAB)
				m_BODY_TAB.Create(ENT_BODY_TAB, this);

			m_BODY_TAB.EnableWindow(TRUE);
			m_BODY_TAB.ShowWindow(SW_SHOWNORMAL);
			break;
    }
    return(ret);
}


ent_EntityProperties::ent_EntityProperties():IcadDialog(ENT_GENERAL), m_editHL(this, NULL)
{
    int i;

    m_TabsFlag=0;
    m_PrvSel=0;
    m_CurSel=0;
    for(i=0;i<ENT_NUM_OF_ENTITIES;i++) m_TabIndex[i]=0;

    //These functions will fill the member variables
    //from the structure using all of the entities and
    //combining the results into one variable.
    ent_EntityProperties::ent_GetLayer();
    ent_EntityProperties::ent_GetLinetype();
    ent_EntityProperties::ent_GetLTScale();
    ent_EntityProperties::ent_GetThickness();
    ent_EntityProperties::ent_GetColor();
    ent_EntityProperties::ent_GetLweight(); // EBATECH(CNBR) 31-03-2003 Bugzilla#78471 Support Lineweight
    ent_bHitEnter=false;
}

void ent_EntityProperties::EnableControlsForHatch(BOOL enable)
{
	CWnd *wnd = GetDlgItem(GEN_THICKNESS);
	wnd->EnableWindow(enable);

	wnd = GetDlgItem(UPDN_GENTHICK);
	wnd->EnableWindow(enable);

	wnd = GetDlgItem(GEN_LINETYPE);
	wnd->EnableWindow(enable);

	wnd = GetDlgItem(GEN_LTSCALE);
	wnd->EnableWindow(enable);

	wnd = GetDlgItem(UPDN_GENSCALE);
	wnd->EnableWindow(enable);

	// also control the labels
	wnd = GetDlgItem(STATIC_THICK);
	wnd->EnableWindow(enable);

	wnd = GetDlgItem(STATIC_LINETYPE);
	wnd->EnableWindow(enable);

	wnd = GetDlgItem(STATIC_LTSCALE);
	wnd->EnableWindow(enable);

}

//Modified Cybage MM 24-09-2001 DD-MM-YYYY [
//Reason : Bug No.- 77847 from Bugzilla
void ent_EntityProperties::EnableControlsForImage(BOOL enable)
{
	CWnd *wnd = GetDlgItem(GEN_THICKNESS);
	wnd->EnableWindow(enable);

	// also control the labels
	wnd = GetDlgItem(STATIC_THICK);
	wnd->EnableWindow(enable);

	#ifdef BUILD_WITH_RASTER_SUPPORT
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC_MESSAGE),SW_HIDE);
	#else
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC_ORIGIN),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC_X),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC_Y),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC_Z),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC_FLAGS),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC_ADJUST),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC_BRIGHTNESS),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC_CONTRAST),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC_FADE),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC_COORDINATES),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IDC_STATIC),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IMAGE_OPX),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IMAGE_OPY),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IMAGE_OPZ),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IMAGE_PICK1),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IMAGE_SHOW_IMAGE),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IMAGE_NON_ORTHO),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IMAGE_SHOW_CLIPPED),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IMAGE_TRANSPARENCY),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IMAGE_BRIGHTNESS),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IMAGE_CONTRAST),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,IMAGE_FADE),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,UPDN_IMAGE_OPX),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,UPDN_IMAGE_OPY),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,UPDN_IMAGE_OPZ),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,UPDN_IMAGE_BRIGHTNESS),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,UPDN_IMAGE_CONTRAST),SW_HIDE);
		::ShowWindow(::GetDlgItem(m_IMAGE_TAB.m_hWnd,UPDN_IMAGE_FADE),SW_HIDE);
	#endif
}
//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]


void reset_ent_dlgitems(struct ent_DlgItem *edi)
{
	int i;
    struct ent_EntCodes *pTmp;

	for(i=0; i<ent_num_of_vars; i++,edi++){
		edi->SColor=-99;
		edi->CheckBit=0;
		edi->OrgValue=0.0;
		edi->DoOnce=0;
		if(edi->DspValue!=NULL) {
			IC_FREE(edi->DspValue);
			edi->DspValue=NULL;
		}
		while(edi->pRbll!=NULL) {
			pTmp=edi->pRbll->next;
			//free(edi->pRbll); allocated by new has to be deallocated by delete.
			delete edi->pRbll;
			edi->pRbll=pTmp;
		}
		edi->pRbll=NULL;
		edi->pCurll=NULL;
	}
}
//4M Item:17->
void IcadHatchPropDia(db_hatch *hatch, sds_name * hatches=NULL);
//4M Item:17<-

void CMainWindow::IcadEntProps(bool isDiaNeed) {
    char fs1[IC_ACADBUF];
    bool gotone,flag;
    int ret,i,j;
    long len,l;
    double ptTmp[3];
    double ptOrg[3]; // EBATECH(CNBR) 2002/6/20 RAY,XLINE,ELLIPSE Bugzilla 78216
    sds_name ssTmp;
    struct resbuf rb;
    struct cmd_elistll *pSsll,*pCur;

    sds_sslength(SDS_EditPropsSS,&len);
    if(len>0){
        bPlineIsMesh=bPlineIs3D=false;
        pSsll=ent_Data2Struct(SDS_EditPropsSS);
        for(i=0,gotone=false;i<ent_num_of_vars;i++) {
            if(ent_DlgItems[i].pRbll) gotone=true;
        }
        if(gotone==false) {
            //unhighlight the selected enitities
            for(l=0;l<len;l++){
                sds_ssname(SDS_EditPropsSS,l,ssTmp);
                sds_redraw(ssTmp,IC_REDRAW_UNHILITE);
            }
            return;
        }
       	SDS_getvar(NULL,DB_QLUNITS,&rb,SDS_CURDWG,NULL,NULL);
        LUNITS=rb.resval.rint;
       	SDS_getvar(NULL,DB_QLUPREC,&rb,SDS_CURDWG,NULL,NULL);
        LUPREC=rb.resval.rint;
       	SDS_getvar(NULL,DB_QAUNITS,&rb,SDS_CURDWG,NULL,NULL);
        AUNITS=rb.resval.rint;
       	SDS_getvar(NULL,DB_QAUPREC,&rb,SDS_CURDWG,NULL,NULL);
        AUPREC=rb.resval.rint;

        ent_EntityProperties m_EntProps;
		// DP
		char desc[IC_ACADBUF];
		if(cmd_getEntitiesHL(SDS_EditPropsSS, NULL, desc, NULL))
			m_EntProps.m_linkDesc.Format(ResourceString(IDC_HYPERLINK_DESCRIPTION, "Link Description: %s" ), desc); //EBATECH(localize)
		else
			m_EntProps.m_linkDesc.Format(ResourceString(IDC_HYPERLINK_DESCRIPTION_NONE, "Link Description: None" )); //EBATECH(localize)
		m_EntProps.m_editHL.setEntities(SDS_EditPropsSS);
        do {
            ret = isDiaNeed ? m_EntProps.DoModal() : IDOK;	/*D.Gavrilov*/
			// We should apply dimstyle settings if we're called from
			// the ICAD_WNDACTION_DIMVARS case.
            if(ret==IDCANCEL && ent_bHitEnter==false) {
                //3DFACE PICK
                if(m_EntProps.m_3DFACE_TAB.ent_Pick1==1) {
                    m_EntProps.m_3DFACE_TAB.ent_Pick1=0;
                    for(i=0;ent_DlgItems[i].ID!=FACE_P1X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_PO_48, "\nSelect point 1: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_3DFACE_TAB.ent_Pick2==1) {
                    m_EntProps.m_3DFACE_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=FACE_P2X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_PO_49, "\nSelect point 2: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_3DFACE_TAB.ent_Pick3==1) {
                    m_EntProps.m_3DFACE_TAB.ent_Pick3=0;
                    for(i=0;ent_DlgItems[i].ID!=FACE_P3X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_PO_50, "\nSelect point 3: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_3DFACE_TAB.ent_Pick4==1) {
                    m_EntProps.m_3DFACE_TAB.ent_Pick4=0;
                    for(i=0;ent_DlgItems[i].ID!=FACE_P4X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_PO_51, "\nSelect point 4: " ),ptTmp)!=RTNORM) continue;
                //ARC PICK
                }else if(m_EntProps.m_ARC_TAB.ent_Pick==1) {
                    m_EntProps.m_ARC_TAB.ent_Pick=0;
                    for(i=0;ent_DlgItems[i].ID!=ARC_CPX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_AR_52, "\nSelect arc center point: " ),ptTmp)!=RTNORM) continue;
                //ATTDEF PICK
                }else if(m_EntProps.m_ATTDEF_TAB.ent_Pick1==1) {
                    m_EntProps.m_ATTDEF_TAB.ent_Pick1=0;
                    for(i=0;ent_DlgItems[i].ID!=ATTD_SPX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_TE_53, "\nSelect text start point: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_ATTDEF_TAB.ent_Pick2==1) {
                    m_EntProps.m_ATTDEF_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=ATTD_APX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_AL_54, "\nSelect alignment point: " ),ptTmp)!=RTNORM) continue;
                //ATTRIB PICK
                }else if(m_EntProps.m_ATTRIB_TAB.ent_Pick1==1) {
                    m_EntProps.m_ATTRIB_TAB.ent_Pick1=0;
                    for(i=0;ent_DlgItems[i].ID!=ATTR_SPX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_TE_53, "\nSelect text start point: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_ATTRIB_TAB.ent_Pick2==1) {
                    m_EntProps.m_ATTRIB_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=ATTR_APX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_AL_54, "\nSelect alignment point: " ),ptTmp)!=RTNORM) continue;
                //CIRCLE PICK
                }else if(m_EntProps.m_CIRCLE_TAB.ent_Pick==1) {
                    m_EntProps.m_CIRCLE_TAB.ent_Pick=0;
                    for(i=0;ent_DlgItems[i].ID!=CIRCLE_CPX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_CI_55, "\nSelect circle center point: " ),ptTmp)!=RTNORM) continue;
                //DIM PICK
                }else if(m_EntProps.m_DIM_TAB.ent_Pick==1) {
                    m_EntProps.m_DIM_TAB.ent_Pick=0;
                    for(i=0;ent_DlgItems[i].ID!=DIM_IPX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_DI_56, "\nSelect dimension point: " ),ptTmp)!=RTNORM) continue;
                //ELLIPSE PICK
                }else if(m_EntProps.m_ELP_TAB.ent_Pick1==1) {
                    m_EntProps.m_ELP_TAB.ent_Pick1=0;
                    for(i=0;ent_DlgItems[i].ID!=ELP_STX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                // EBATECH(CNBR) -[ 2002/6/20 Bugzilla 78216 Ellipse Center point
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_EL_69, "\nSelect ellipse center point: " ),ptTmp)!=RTNORM) continue;
                    //if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_ST_57, "\nSelect start point: " ),ptTmp)!=RTNORM) continue;
                // EBATECH(CNBR) -[ 2002/6/20 Bugzilla 78216 Ellipse Major Axis is Relative Value from Center point.
                }else if(m_EntProps.m_ELP_TAB.ent_Pick2==1) {
                    m_EntProps.m_ELP_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=ELP_STX;i++); // Get Origin in ELP_STX
                    for(flag=false,j=0;j<=2;i++,j++) {
                        ptOrg[j]=ent_DlgItems[i].OrgValue;
                    }
                    for(i=0;ent_DlgItems[i].ID!=ELP_EPX;i++); // Set i ELP_EPX
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint(ptOrg,ResourceString(IDC_ICADENTPROP__NSELECT_EL_70, "\nSelect major axis end point: " ),ptTmp)!=RTNORM) continue;
                    ptTmp[0] -= ptOrg[0];	ptTmp[1] -= ptOrg[1];	ptTmp[2] -= ptOrg[2];
                /*
                }else if(m_EntProps.m_ELP_TAB.ent_Pick2==1) {
                    m_EntProps.m_ELP_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=ELP_EPX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_EN_58, "\nSelect end point: " ),ptTmp)!=RTNORM) continue;
                */
                //EBATECH(CNBR) ]-
                //Modified Cybage MM 24-09-2001 DD-MM-YYYY [
				//Reason : Bug No.- 77847 from Bugzilla
				//IMAGE PICK
               }else if(m_EntProps.m_IMAGE_TAB.ent_Pick==1) {
                    m_EntProps.m_IMAGE_TAB.ent_Pick=0;
                    for(i=0;ent_DlgItems[i].ID!=IMAGE_OPX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_PO_70, "\nSelect a point in the drawing: " ),ptTmp)!=RTNORM) continue;
				//Modified Cybage MM 24-09-2001 DD-MM-YYYY ]
                //INSERT PICK
               }else if(m_EntProps.m_INSERT_TAB.ent_Pick==1) {
                    m_EntProps.m_INSERT_TAB.ent_Pick=0;
                    for(i=0;ent_DlgItems[i].ID!=INSERT_IPX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
						// Bugzilla No. 78215; 01/07/2002
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_IN_59, "\nSelect insertion point: "),ptTmp)!=RTNORM) continue; // EBATECH(CNBR) 2002/4/24 Use ResourceString.
/*	what are attributes doing here?
                    if((m_EntProps.m_ATTRIB_TAB.iJust72&1 && m_EntProps.m_ATTRIB_TAB.iJust74&1) ||
                        m_EntProps.m_ATTRIB_TAB.iJust72&8 || m_EntProps.m_ATTRIB_TAB.iJust72&32) {
                        for(i=0;ent_DlgItems[i].ID!=ATTR_SPX;i++);
                    }else{
                        for(i=0;ent_DlgItems[i].ID!=ATTR_APX;i++);
                    }
                    for(j=0;j<=2;i++,j++) {
                        sds_rtos(ptTmp[j],-1,-1,fs1);
                        ent_DlgItems[i].DspValue=(char *)realloc(ent_DlgItems[i].DspValue,strlen(fs1)+1); //realloc memory
                        strcpy(ent_DlgItems[i].DspValue,fs1);
                    }
*/
                //LINE PICK
                }else if(m_EntProps.m_LINE_TAB.ent_Pick1==1) {
                    m_EntProps.m_LINE_TAB.ent_Pick1=0;
                    for(i=0;ent_DlgItems[i].ID!=LINE_STX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_ST_57, "\nSelect start point: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_LINE_TAB.ent_Pick2==1) {
                    m_EntProps.m_LINE_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=LINE_EDX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_EN_58, "\nSelect end point: " ),ptTmp)!=RTNORM) continue;
                //MTEXT PICK
                }else if(m_EntProps.m_MTEXT_TAB.ent_Pick==1) {
                    m_EntProps.m_MTEXT_TAB.ent_Pick=0;
                    for(i=0;ent_DlgItems[i].ID!=MTEXT_ORIGIN_X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_OR_60, "\nSelect origin point: " ),ptTmp)!=RTNORM) continue;
  //todo              //PLINE PICK
                }else if(m_EntProps.m_LWPLINE_TAB.ent_Pick==1) {
                    m_EntProps.m_LWPLINE_TAB.ent_Pick=0;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint(NULL,ResourceString(IDC_ICADENTPROP__NSELECT_EN_58, "\nSelect end point: " ),ptTmp) EQ RTNORM)
						m_EntProps.m_LWPLINE_TAB.SelectVertex( ptTmp);
					continue;

                }else if(m_EntProps.m_PLINE_TAB.ent_Pick==1) {
                    m_EntProps.m_PLINE_TAB.ent_Pick=0;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint(NULL,ResourceString(IDC_ICADENTPROP__NSELECT_EN_58, "\nSelect end point: " ),ptTmp)!=RTNORM) continue;
                    m_EntProps.m_PLINE_TAB.pRb=m_EntProps.m_PLINE_TAB.pCurV->entlst;
                    while((m_EntProps.m_PLINE_TAB.pRb!=NULL) && (m_EntProps.m_PLINE_TAB.pRb->restype!=10)) {
                        m_EntProps.m_PLINE_TAB.pRb=m_EntProps.m_PLINE_TAB.pRb->rbnext;
                    }
                    if(m_EntProps.m_PLINE_TAB.pRb->restype==10) {
                        m_EntProps.m_PLINE_TAB.pRb->resval.rpoint[0]=ptTmp[0];
                        m_EntProps.m_PLINE_TAB.pRb->resval.rpoint[1]=ptTmp[1];
                        m_EntProps.m_PLINE_TAB.pRb->resval.rpoint[2]=ptTmp[2];
                    }
                    continue;
                //POINT PICK
                }else if(m_EntProps.m_POINT_TAB.ent_Pick==1) {
                    m_EntProps.m_POINT_TAB.ent_Pick=0;
                    for(i=0;ent_DlgItems[i].ID!=POINT_CPX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_PO_61, "\nSelect point: " ),ptTmp)!=RTNORM) continue;
                //RAY PICK
                }else if(m_EntProps.m_RAY_TAB.ent_Pick1==1) {
                    m_EntProps.m_RAY_TAB.ent_Pick1=0;
                    for(i=0;ent_DlgItems[i].ID!=RAY_STX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_ST_57, "\nSelect start point: " ),ptTmp)!=RTNORM) continue;
                // EBATECH(CNBR) -[ 2002/6/20 Bugzilla 78216 RAY DISTANCE is retative from Origin.
                }else if(m_EntProps.m_RAY_TAB.ent_Pick2==1) {
                    m_EntProps.m_RAY_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=RAY_STX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        ptOrg[j]=ent_DlgItems[i].OrgValue;
                    }
                    for(i=0;ent_DlgItems[i].ID!=RAY_EDX;i++);
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint(ptOrg,ResourceString(IDC_ICADENTPROP__NSELECT_RX_71, "\nSelect direction: " ),ptTmp)!=RTNORM) continue;
                    ptTmp[0] -= ptOrg[0]; ptTmp[1] -= ptOrg[1]; ptTmp[2] -= ptOrg[2];
                /*
                }else if(m_EntProps.m_RAY_TAB.ent_Pick2==1) {
                    m_EntProps.m_RAY_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=RAY_EDX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_EN_58, "\nSelect end point: " ),ptTmp)!=RTNORM) continue;
                */
                // EBATECH(CNBR) ]-
                //SHAPE PICK // EBATECH(CNBR) -[ 2002/4/24
                }else if(m_EntProps.m_SHAPE_TAB.ent_Pick==1) {
                    m_EntProps.m_SHAPE_TAB.ent_Pick=0;
                    for(i=0;ent_DlgItems[i].ID!=SHAPE_ORIGIN_X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_IN_59, "\nSelect insertion point: "),ptTmp)!=RTNORM) continue;
                // EBATECH(CNBR) ]-
                //SOLID PICK
                }else if(m_EntProps.m_SOLID_TAB.ent_Pick1==1) {
                    m_EntProps.m_SOLID_TAB.ent_Pick1=0;
                    for(i=0;ent_DlgItems[i].ID!=SOLID_P1X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_SO_62, "\nSelect solid point 1: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_SOLID_TAB.ent_Pick2==1) {
                    m_EntProps.m_SOLID_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=SOLID_P2X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_SO_63, "\nSelect solid point 2: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_SOLID_TAB.ent_Pick3==1) {
                    m_EntProps.m_SOLID_TAB.ent_Pick3=0;
                    for(i=0;ent_DlgItems[i].ID!=SOLID_P3X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_SO_64, "\nSelect solid point 3: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_SOLID_TAB.ent_Pick4==1) {
                    m_EntProps.m_SOLID_TAB.ent_Pick4=0;
                    for(i=0;ent_DlgItems[i].ID!=SOLID_P4X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_SO_65, "\nSelect solid point 4: " ),ptTmp)!=RTNORM) continue;
                //TEXT PICK
                }else if(m_EntProps.m_TEXT_TAB.ent_Pick==1) {
                    m_EntProps.m_TEXT_TAB.ent_Pick=0;
                    for(i=0;ent_DlgItems[i].ID!=TEXT_ORIGIN_X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_TE_66, "\nSelect text origin: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_TEXT_TAB.ent_Pick2==1) {
                    m_EntProps.m_TEXT_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=TEXT_ALIGN_X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_TE_67, "\nSelect text alignment point: " ),ptTmp)!=RTNORM) continue;
                //TOLERANCE PICK
                }else if(m_EntProps.m_TOLER_TAB.ent_Pick==1) {
                    m_EntProps.m_TOLER_TAB.ent_Pick=0;
                    for(i=0;ent_DlgItems[i].ID!=TOLE_STX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_TE_66, "\nSelect text origin: " ),ptTmp)!=RTNORM) continue;
                //TRACE PICK
                }else if(m_EntProps.m_TRACE_TAB.ent_Pick1==1) {
                    m_EntProps.m_TRACE_TAB.ent_Pick1=0;
                    for(i=0;ent_DlgItems[i].ID!=TRACE_P1X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_PO_48, "\nSelect point 1: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_TRACE_TAB.ent_Pick2==1) {
                    m_EntProps.m_TRACE_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=TRACE_P2X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_PO_49, "\nSelect point 2: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_TRACE_TAB.ent_Pick3==1) {
                    m_EntProps.m_TRACE_TAB.ent_Pick3=0;
                    for(i=0;ent_DlgItems[i].ID!=TRACE_P3X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_PO_50, "\nSelect point 3: " ),ptTmp)!=RTNORM) continue;
                }else if(m_EntProps.m_TRACE_TAB.ent_Pick4==1) {
                    m_EntProps.m_TRACE_TAB.ent_Pick4=0;
                    for(i=0;ent_DlgItems[i].ID!=TRACE_P4X;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_PO_51, "\nSelect point 4: " ),ptTmp)!=RTNORM) continue;
                //VIEWPORT PICK
                }else if(m_EntProps.m_VIEWP_TAB.ent_Pick==1) {
                    m_EntProps.m_VIEWP_TAB.ent_Pick=0;
                    for(i=0;ent_DlgItems[i].ID!=VIEWP_CPX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_VI_68, "\nSelect viewport center point: " ),ptTmp)!=RTNORM) continue;
                //XLINE PICK
                }else if(m_EntProps.m_XLINE_TAB.ent_Pick1==1) {
                    m_EntProps.m_XLINE_TAB.ent_Pick1=0;
                    for(i=0;ent_DlgItems[i].ID!=XLINE_STX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_ST_57, "\nSelect start point: " ),ptTmp)!=RTNORM) continue;
                // EBATECH(CNBR) -[ 2002/6/20 Bugzilla 78216 XLINE DISTANCE is retative from Origin.
                }else if(m_EntProps.m_XLINE_TAB.ent_Pick2==1) {
                    m_EntProps.m_XLINE_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=XLINE_STX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        ptOrg[j]=ent_DlgItems[i].OrgValue;
                    }
                    for(i=0;ent_DlgItems[i].ID!=XLINE_EDX;i++);
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint(ptOrg,ResourceString(IDC_ICADENTPROP__NSELECT_RX_71, "\nSelect direction: " ),ptTmp)!=RTNORM) continue;
                    ptTmp[0] -= ptOrg[0]; ptTmp[1] -= ptOrg[1]; ptTmp[2] -= ptOrg[2];
                /*
                }else if(m_EntProps.m_XLINE_TAB.ent_Pick2==1) {
                    m_EntProps.m_XLINE_TAB.ent_Pick2=0;
                    for(i=0;ent_DlgItems[i].ID!=XLINE_EDX;i++);
                    for(flag=false,j=0;j<=2;i++,j++) {
                        if(strisame(ResourceString(IDC_ICADENTPROP_VARIES_47, "VARIES" ),ent_DlgItems[i].DspValue)) flag=true;
                        ptTmp[j]=ent_DlgItems[i].OrgValue;
                    }
                    i-=3;
                    sds_initget(9|SDS_RSG_NODOCCHG,NULL);
                    if(internalGetpoint((flag)?NULL:ptTmp,ResourceString(IDC_ICADENTPROP__NSELECT_EN_58, "\nSelect end point: " ),ptTmp)!=RTNORM) continue;
                */
                // EBATECH(CNBR) ]-
                }else{
                    //unhighlight the selected enitities
                    for(l=0;l<len;l++){
                        sds_ssname(SDS_EditPropsSS,l,ssTmp);
                        sds_redraw(ssTmp,IC_REDRAW_UNHILITE);
                    }
                    //This section is to free up all of the storage areas
                    //without saving any information
                    sds_ssfree(SDS_EditPropsSS);
                    cmd_free_elistll(&pSsll,NULL);
					reset_ent_dlgitems(ent_DlgItems);
                    break;
                }
                for(j=0;j<=2;i++,j++) {
                    sds_rtos(ptTmp[j],-1,-1,fs1);
                    ent_DlgItems[i].DspValue=ic_realloc_char(ent_DlgItems[i].DspValue,strlen(fs1)+1); //realloc memory
                    strcpy(ent_DlgItems[i].DspValue,fs1);
                }
            }else if(ret==IDOK||(ret==IDCANCEL && ent_bHitEnter==true)) {
                ent_Struct2ll();

				// We are temporarily setting SDS_AtNodeDrag to 1 so that, deep down,
				// inside cmd_geteedvalues, the correct parlink_vars will be set.
				int SavedSDS_AtNodeDrag;
				SavedSDS_AtNodeDrag = SDS_AtNodeDrag;

                for(pCur=pSsll;pCur!=NULL;pCur=pCur->next)
				{
					if(((db_handitem*)(pCur->ename[0]))->ret_type() == DB_DIMENSION)
					{
						SDS_AtNodeDrag = 1;
						sds_entmod(pCur->entlst);
						SDS_AtNodeDrag = SavedSDS_AtNodeDrag;
					}
					else
						sds_entmod(pCur->entlst);
				}
				if(m_EntProps.m_editHL.isApplyLater())
					m_EntProps.m_editHL.OnApply();

				SDS_RedrawDrawing(SDS_CURDWG, NULL, NULL, 1);	/*D.G.*/// redraw all

				cmd_updateSSReactors(SDS_EditPropsSS);

                //This section is to free up all of the storage areas
				sds_ssfree(SDS_EditPropsSS);
                cmd_free_elistll(&pSsll,NULL);
                reset_ent_dlgitems(ent_DlgItems);
                break;
//4M Item:17->
// BHatch edit
            }else if (ret==HATCH_HATCHEDIT){
                //Go to the proper index of the struct
               for(int index=0;(ent_DlgItems[index].EntTyp!=DB_HATCH || ent_DlgItems[index].DXFCode!=5);index++); //Find the start of the section
               struct ent_EntCodes * pCur=ent_DlgItems[index].pRbll;
               if (pCur){
                  sds_name ename;
                  sds_handent(pCur->prbb->resval.rstring,ename);
                  db_hatch * hatchEntity=(db_hatch *) ename[0];
                  sds_name hatches;
                  pCur=pCur->next;
                  while (pCur){
                     sds_name nextname;
                     sds_handent(pCur->prbb->resval.rstring,nextname);
                     sds_ssadd(nextname,hatches,hatches);
                     pCur=pCur->next;
                  }
                  IcadHatchPropDia(hatchEntity,&hatches);
                  sds_ssfree(hatches);

                  cmd_free_elistll(&pSsll,NULL);
                  reset_ent_dlgitems(ent_DlgItems);
                  pSsll=ent_Data2Struct(SDS_EditPropsSS);
               }
//<-4M Item:17
            }else{
                break;
            }
        }while(1);
    }
}
